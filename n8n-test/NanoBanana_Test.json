{
  "name": "NanoBanana_Test",
  "nodes": [
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "=models/gemini-2.5-flash-image-preview",
          "mode": "id"
        },
        "prompt": "A dog eating a hotdog",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        208,
        144
      ],
      "id": "03be9996-7ccb-4923-abe6-5cd5ae02a03a",
      "name": "Generate an image",
      "credentials": {
        "googlePalmApi": {
          "id": "vhb8mOyWWRrLq5Ra",
          "name": "NanoBanana-Test"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent\n",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\" : [{\n    \"parts\": [\n      {\"text\" : \"{{ $json.Prompt }}\"}\n    ]\n  }],\n  \"generationConfig\": {\n    \"responseModalities\": [\"TEXT\", \"IMAGE\"],\n    \"imageConfig\": {\n      \"aspectRatio\": \"16:9\",\n      \"imageSize\": \"1K\"\n    }\n  } \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        208,
        320
      ],
      "id": "b8c55650-50f7-4ea8-8cac-5d40dc0af589",
      "name": "HTTP Request",
      "credentials": {
        "httpHeaderAuth": {
          "id": "byaaZUic5fl64TPn",
          "name": "Nano Banana"
        }
      }
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "candidates[0].content.parts[0].inlineData.data",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        416,
        320
      ],
      "id": "2576613b-bad8-4d70-8635-e50cb6417a8b",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "content": "## 이미지 생성 Flow\n- 간단한 Prompt로 이미지 생성.",
        "height": 192,
        "width": 928,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -304,
        288
      ],
      "id": "9b293695-aa4b-4d3f-b00e-bb41bfec6beb",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "formTitle": "Create Image",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Image",
              "fieldType": "file",
              "multipleFiles": false,
              "requiredField": true
            },
            {
              "fieldLabel": "Prompt",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        0,
        544
      ],
      "id": "00fbb50e-dcd7-47a1-8f31-de72808e79dc",
      "name": "Edit Image",
      "webhookId": "05705f88-bcb0-411c-82f4-dd366de60e74"
    },
    {
      "parameters": {
        "formTitle": "Create Image",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Prompt",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        0,
        320
      ],
      "id": "10fecafa-9686-458d-87fc-632e01f306ff",
      "name": "Create Image",
      "webhookId": "f14dcc0c-956a-4c16-b059-2c56998b4337"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent\n",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\" : [{\n    \"parts\": [\n      {\"text\" : \"{{ $('Edit Image').item.json.Prompt }}\"},\n      {\n        \"inline_data\": {\n          \"mime_type\": \"image/jpeg\",\n          \"data\": \"{{ $json.data }}\"\n        }\n      }\n    ]\n  }],\n  \"generationConfig\": {\n    \"responseModalities\": [\"TEXT\", \"IMAGE\"],\n    \"imageConfig\": {\n      \"aspectRatio\": \"16:9\",\n      \"imageSize\": \"1K\"\n    }\n  } \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        352,
        544
      ],
      "id": "2e6bd876-b315-4dd6-8300-d2cf02bc5cd4",
      "name": "HTTP Request1",
      "credentials": {
        "httpHeaderAuth": {
          "id": "byaaZUic5fl64TPn",
          "name": "Nano Banana"
        }
      }
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        176,
        544
      ],
      "id": "00094860-5074-4150-88bc-ca25c778991f",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "candidates[0].content.parts[0].inlineData.data",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        544,
        544
      ],
      "id": "6be91196-bbbb-463e-833d-eaf9117669b2",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "content": "## 이미지 수정 Flow\n- 원하는 Prompt로 이미지 변환",
        "height": 192,
        "width": 1104
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -304,
        512
      ],
      "id": "3c398b58-37c6-4694-bfc0-abc1990c189e",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\" : [{\n    \"parts\": [\n      {\"text\" : \"{{ $('Multiple Images').item.json.Prompt }}\"},\n      {\n        \"inline_data\": {\n          \"mime_type\": \"image/jpeg\",\n          \"data\": \"{{ $('Extract from File1').all()[0].json.Image1 }}\"\n        }\n      },\n       {\n        \"inline_data\": {\n          \"mime_type\": \"image/jpeg\",\n          \"data\": \"{{ $('Extract from File2').all()[0].json.Image2 }}\"\n        }\n      }\n    ]\n  }],\n  \"generationConfig\": {\n    \"responseModalities\": [\"TEXT\", \"IMAGE\"],\n    \"imageConfig\": {\n      \"aspectRatio\": \"16:9\",\n      \"imageSize\": \"1K\"\n    }\n  } \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        448,
        784
      ],
      "id": "25893c66-b49a-4f8d-9d39-0108cfc681c4",
      "name": "HTTP Request2",
      "credentials": {
        "httpHeaderAuth": {
          "id": "byaaZUic5fl64TPn",
          "name": "Nano Banana"
        }
      }
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Image1",
        "destinationKey": "Image1",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        96,
        784
      ],
      "id": "3734920d-93cf-4517-aac9-9020706bad2f",
      "name": "Extract from File1"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "candidates[0].content.parts[0].inlineData.data",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        624,
        784
      ],
      "id": "52896637-0323-46e3-bbf1-1afec71000d2",
      "name": "Convert to File2"
    },
    {
      "parameters": {
        "content": "## 이미지 병합\n- 원하는 Prompt로 이미지 병합",
        "height": 208,
        "width": 1152,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -304,
        736
      ],
      "id": "2c959a69-ce12-44c0-b493-9b2a7408986c",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "formTitle": "Create Image",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Image1",
              "fieldType": "file",
              "multipleFiles": false,
              "requiredField": true
            },
            {
              "fieldLabel": "Image2",
              "fieldType": "file",
              "multipleFiles": false,
              "requiredField": true
            },
            {
              "fieldLabel": "Prompt",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -64,
        784
      ],
      "id": "e7d6d999-985d-49ba-947c-a2a1399b9b81",
      "name": "Multiple Images",
      "webhookId": "be08bc5d-d5a1-4199-bef5-d82cb31023fd"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Image2",
        "destinationKey": "Image2",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        256,
        784
      ],
      "id": "6494664b-c41d-4f60-bff3-53040fbb4df9",
      "name": "Extract from File2"
    },
    {
      "parameters": {
        "formTitle": "ImageEditor",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Main_Image",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        1088,
        304
      ],
      "id": "1804051d-b158-449d-81ac-9cda5a56b30d",
      "name": "Image Editor3",
      "webhookId": "1ac6e516-7c80-49ad-9e86-d3bef7d53d18"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Main_Image",
        "destinationKey": "Main_Image",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1472,
        304
      ],
      "id": "c264dd66-368e-44d6-9862-d3c37c5ec9e1",
      "name": "MainImage Convert_6"
    },
    {
      "parameters": {
        "url": "={{ $json.Main_Image }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Main_Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1280,
        304
      ],
      "id": "77cad1be-2bf0-43b8-a43d-b661f03b967d",
      "name": "MainImage Convert_7"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent\n",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\" : [{\n    \"parts\": [\n      {\n          \"text\": {{ $json.cleanedPrompt }}\n        },\n      {\n        \"inline_data\": {\n          \"mime_type\": \"image/jpeg\",\n          \"data\": \"{{ $('MainImage Convert_6').item.json.Main_Image }}\"\n        }\n      }\n    ]\n  }],\n  \"generationConfig\": {\n    \"responseModalities\": [\"TEXT\", \"IMAGE\"],\n    \"imageConfig\": {\n      \"aspectRatio\": \"4:5\",\n      \"imageSize\": \"1K\"\n    }\n  } \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2080,
        304
      ],
      "id": "07ff17dd-2b42-42f8-8f52-865dd41f1766",
      "name": "HTTP Request5",
      "credentials": {
        "httpHeaderAuth": {
          "id": "byaaZUic5fl64TPn",
          "name": "Nano Banana"
        }
      }
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "candidates[0].content.parts[0].inlineData.data",
        "binaryPropertyName": "MainImage",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        2256,
        304
      ],
      "id": "4cb1a6e7-310b-4081-8ff7-93736143608a",
      "name": "Convert to File7"
    },
    {
      "parameters": {
        "content": "## 썸네일 이미지 인물 입히기",
        "height": 256,
        "width": 1520,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1024,
        224
      ],
      "id": "350ac27a-eda7-48c8-8777-7f92fa4a51a6",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "시트1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Prompt Name",
              "lookupValue": "MainImage Prompt"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1680,
        304
      ],
      "id": "69cc156c-e922-4bf1-8af7-9584116a1e2c",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Isn2z9duv7UXzATf",
          "name": "Google Sheets Juunnmmoo"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n  item.json.cleanedPrompt = JSON.stringify(item.json.Prompt);\n}\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1888,
        304
      ],
      "id": "df674f4a-80a9-458c-81d5-96f860ce16c9",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent\n",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\" : [{\n    \"parts\": [\n      {\n          \"text\": {{ $json.cleanedPrompt }}\n        },\n      {\n        \"inline_data\": {\n          \"mime_type\": \"image/jpeg\",\n          \"data\": \"{{ $('MainImage Convert_').item.json.Main_Image }}\"\n        }\n      }\n    ]\n  }],\n  \"generationConfig\": {\n    \"responseModalities\": [\"TEXT\", \"IMAGE\"],\n    \"imageConfig\": {\n      \"aspectRatio\": \"4:5\",\n      \"imageSize\": \"1K\"\n    }\n  } \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2080,
        832
      ],
      "id": "e8aa9479-655a-4b1f-8a2f-587dc104d667",
      "name": "HTTP Request6",
      "credentials": {
        "httpHeaderAuth": {
          "id": "byaaZUic5fl64TPn",
          "name": "Nano Banana"
        }
      }
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "candidates[0].content.parts[0].inlineData.data",
        "binaryPropertyName": "MainImage",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        2256,
        832
      ],
      "id": "0de622e3-4434-4746-bd88-83ae63ed53dc",
      "name": "Convert to File8"
    },
    {
      "parameters": {
        "content": "## 상세이미지 수정",
        "height": 256,
        "width": 1520,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1024,
        752
      ],
      "id": "cc606d1c-b899-4af3-95c4-853fdd42d9ff",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "시트1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Prompt Name",
              "lookupValue": "MainImage Prompt"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1680,
        832
      ],
      "id": "15e7b657-2b7c-4f5e-98f5-965e8f056c3c",
      "name": "Get row(s) in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Isn2z9duv7UXzATf",
          "name": "Google Sheets Juunnmmoo"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n  item.json.cleanedPrompt = JSON.stringify(item.json.Prompt);\n}\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1888,
        832
      ],
      "id": "71e2e8e2-ce1d-4415-b615-cd48e37968fc",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=첨부된 상세이미지를 분석하여 3가지 영역으로 분류하고, 각 영역의 픽셀 좌표를 JSON으로 반환해줘.\n\n## 영역 정의\n\n### 1. logo_and_product_section (헤더 영역)\n- 포함: 브랜드 로고, 제품명, 가격, 제품 설명 텍스트\n- 제품 사진: 최대 1장만 포함 (대표 썸네일)\n- 끝 경계: 두 번째 제품 사진이 시작되기 직전\n\n### 2. product_image_section (제품 사진 영역)  \n- 포함: 흰 배경 제품 단독 사진들 (정면, 후면, 디테일컷 등)\n- 제외: 텍스트가 포함된 영역 (텍스트 발견 시 즉시 영역 종료)\n\n### 3. info_section (판매정보 영역)\n- 포함: 사이즈표, 소재정보, 세탁방법, 주의사항 등 텍스트/표 정보\n- 제외: 제품 사진 (제품 사진이 포함되면 안 됨)\n- 시작 경계: 판매정보 텍스트 시작점\n\n## 필수 규칙\n1. 각 영역의 상단/하단 경계에서 제품 사진이나 텍스트가 잘리면 안 됨\n2. 영역 간 겹침 없이 깔끔하게 분리\n3. 여백은 포함해도 되지만, 콘텐츠 잘림은 불가\n\n## 출력 형식\n추가 설명 없이 아래 JSON 구조만 반환:\n\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": [\n    {\n      \"type\": \"logo_and_product_section\",\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    },\n    {\n      \"type\": \"product_image_section\",\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    },\n    {\n      \"type\": \"info_section\",\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    }\n  ]\n}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1680,
        1296
      ],
      "id": "3f1518c2-5641-4021-a0f2-4eb1734d0e3d",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "url": "={{ $json.Main_Image }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Main_Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1280,
        832
      ],
      "id": "a163d9ce-bc50-4a31-ae9c-e477f9e5bdc3",
      "name": "MainImage Convert_8"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Main_Image",
        "destinationKey": "Main_Image",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1472,
        832
      ],
      "id": "ece5cd11-68f0-44fc-9963-e48806e6af5d",
      "name": "MainImage Convert_"
    },
    {
      "parameters": {
        "formTitle": "ImageEditor",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Main_Image",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        1088,
        832
      ],
      "id": "cb71aa40-6601-4957-8cbe-ea2af016f02e",
      "name": "Image Editor4",
      "webhookId": "7b9d5b99-75a7-45a6-bf54-c01d120603af"
    },
    {
      "parameters": {
        "url": "={{ $json.Main_Image }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1264,
        1296
      ],
      "id": "14defd71-6ba7-4bb0-b9de-94a4d2e7169d",
      "name": "MainImage Convert_9"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Image",
        "destinationKey": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1456,
        1296
      ],
      "id": "cc77efdc-5ea4-4a93-90cd-2405703a3a29",
      "name": "MainImage Convert_1"
    },
    {
      "parameters": {
        "formTitle": "ImageEditor",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Main_Image",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        1072,
        1296
      ],
      "id": "077a66b5-e27f-4a98-99ec-0711f6c60fb0",
      "name": "Image Editor",
      "webhookId": "730d71b1-04bf-4479-a888-6115416dfeb5"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Image Editor').all()[0].json.submittedAt }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        1776,
        1488
      ],
      "id": "d5f2dec1-cb07-4734-9096-cee89c6c0722",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "jsCode": "const results = [];\n\nfor (const item of $input.all()) {\n  let raw = item.json.output || \"\";\n\n  // 코드블록 제거\n  raw = raw\n    .replace(/```json/g, \"\")\n    .replace(/```/g, \"\")\n    .trim();\n\n  let parsed;\n  try {\n    parsed = JSON.parse(raw);\n  } catch (e) {\n    continue; // 파싱 불가 시 스킵\n  }\n\n  // 배열 보정\n  const brand = parsed.brand_sections || [];\n  const product = parsed.product_image_sections || [];\n  const info = parsed.info_sections || [];\n\n  // 1) brand → 개별 item\n  for (const sec of brand) {\n    results.push({\n      json: {\n        section_type: \"brand\",\n        ...sec\n      }\n    });\n  }\n\n  // 2) product → 개별 item\n  for (const sec of product) {\n    results.push({\n      json: {\n        section_type: \"product_image\",\n        ...sec\n      }\n    });\n  }\n\n  // 3) info → 개별 item\n  for (const sec of info) {\n    results.push({\n      json: {\n        section_type: \"info\",\n        ...sec\n      }\n    });\n  }\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1984,
        1296
      ],
      "id": "659b5384-63c6-44a6-a5cb-ee2ce1d2f055",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2272,
        1296
      ],
      "id": "d86c4f5f-1e59-4c51-9f97-0789bbcaf1ac",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items1').all()[0].json.width }}",
        "height": "={{ $('Loop Over Items1').all()[0].json.height }}",
        "positionX": "={{ $('Loop Over Items1').all()[0].json.x }}",
        "positionY": "={{ $('Loop Over Items1').all()[0].json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2736,
        1456
      ],
      "id": "5ab42a1e-6b12-4708-83ea-3bdb3ae60afe",
      "name": "Edit Image4"
    },
    {
      "parameters": {
        "url": "={{ $('Image Editor').all()[0].json.Main_Image }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2480,
        1344
      ],
      "id": "478544ef-047e-4bdd-8777-5a768282fd50",
      "name": "MainImage Convert_11"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2480,
        1200
      ],
      "id": "19b4b690-6921-4104-b43e-e8bbc4582fea",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "claude-sonnet-4-5-20250929",
          "cachedResultName": "Claude Sonnet 4.5"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        1680,
        1488
      ],
      "id": "5a1410fe-e9e9-4b6d-9240-b5d47dea1f51",
      "name": "Anthropic Chat Model1",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list"
        },
        "text": "=첨부된 상세이미지를 분석하여 3가지 영역으로 분류하고, 각 영역의 픽셀 좌표를 JSON으로 반환해줘.\n\n## 영역 정의\n\n### 1. logo_and_product_section (헤더 영역)\n- 포함: 브랜드 로고, 제품명, 가격, 제품 설명 텍스트\n- 제품 사진: 최대 1장만 포함 (대표 썸네일)\n- 끝 경계: 두 번째 제품 사진이 시작되기 직전\n\n### 2. product_image_section (제품 사진 영역)  \n- 포함: 흰 배경 제품 단독 사진들 (정면, 후면, 디테일컷 등)\n- 제외: 텍스트가 포함된 영역 (텍스트 발견 시 즉시 영역 종료)\n- 시작 경계: 첫 번째 영역 종료 직후\n- 끝 경계: 판매정보 텍스트 시작 직전\n\n### 3. info_section (판매정보 영역)\n- 포함: 사이즈표, 소재정보, 세탁방법, 주의사항 등 텍스트/표 정보\n- 제외: 제품 사진 (제품 사진이 포함되면 안 됨)\n- 시작 경계: 판매정보 텍스트 시작점\n\n## 필수 규칙\n1. 각 영역의 상단/하단 경계에서 제품 사진이나 텍스트가 잘리면 안 됨\n2. 영역 간 겹침 없이 깔끔하게 분리\n3. 여백은 포함해도 되지만, 콘텐츠 잘림은 불가\n\n## 출력 형식\n추가 설명 없이 아래 JSON 구조만 반환:\n\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": [\n    {\n      \"type\": \"logo_and_product_section\",\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    },\n    {\n      \"type\": \"product_image_section\",\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    },\n    {\n      \"type\": \"info_section\",\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    }\n  ]\n}",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        1616,
        1872
      ],
      "id": "e760a4d1-3dd4-40b3-91ac-4c7c47aec3de",
      "name": "Analyze image",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQaP4z9XdQJb9YguLzHLbVbwHaPqZTNTxZyt78ZFIUpbvujJ%252BTs5h%252FelsvABXLkm%252F%252B8FkB1dfr9qxd00pJ8LXkW4VQkemzQT9ftZq9Iw3u5xnXN9tRWaK%252FOMYJz6%252FYYqsRftCMxsIx4sZk1F18PIwewwHjuM9c1kaRINJp0nLY6NystjCNCMyWFnI9yzOXp9pWKd6V7YBrcaSXrY6flbKw1djzsvow3sP5I%252B77DtQzG9t3AOhnbISUNp7wUmhnZWQrdxdealDRyh1609ovpIYCF9jegaE395IxUJUvpCY46J5TxrnBtDtkA1KY2f5hjmQxVAMCdpDLn%252FtA1KAyXkZow%253D%253D&width=800&format=webp&quality=100",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1232,
        1872
      ],
      "id": "53a398e3-8b85-4930-bbf3-a30cd217a416",
      "name": "MainImage Convert_12"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "height": 8000,
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        1424,
        1872
      ],
      "id": "5529cea8-ee83-4301-95eb-b53c535c4c06",
      "name": "Edit Image5"
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산 (width는 그대로 둘 예정)\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) width는 그대로 두고 y + height만 보정\n// -----------------------------------------\nfunction scaleBox(section) {\n  return {\n    type: section.type,\n    x: Math.round(section.x * scale),                                 // x 그대로\n    y: Math.round(section.y * scale),             // y 스케일 적용\n    width: Math.round(section.width * scale),                         // width 그대로\n    height: Math.round(section.height * scale),   // height 스케일\n    description: section.description,\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) 개별 item으로 출력\n// -----------------------------------------\nconst outputs = parsed.sections.map(section => ({\n  json: scaleBox(section)\n}));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1824,
        1872
      ],
      "id": "488aa0a7-7010-46cb-bc36-c0d27d7bb092",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2144,
        1872
      ],
      "id": "ea3ce6dd-0b33-4fe3-875f-6de69b0191e3",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items2').all()[0].json.width }}",
        "height": "={{ $('Loop Over Items2').all()[0].json.height }}",
        "positionX": "={{ $('Loop Over Items2').all()[0].json.x }}",
        "positionY": "={{ $('Loop Over Items2').all()[0].json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2624,
        2048
      ],
      "id": "dc08222c-ca28-48b4-acd8-d4c547c2ec54",
      "name": "Edit Image6"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2352,
        1776
      ],
      "id": "efb1b183-497b-47a6-b9ab-8f62bd23ea2d",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQaP4z9XdQJb9YguLzHLbVbwHaPqZTNTxZyt78ZFIUpbvujJ%252BTs5h%252FelsvABXLkm%252F%252B8FkB1dfr9qxd00pJ8LXkW4VQkemzQT9ftZq9Iw3u5xnXN9tRWaK%252FOMYJz6%252FYYqsRftCMxsIx4sZk1F18PIwewwHjuM9c1kaRINJp0nLY6NystjCNCMyWFnI9yzOXp9pWKd6V7YBrcaSXrY6flbKw1djzsvow3sP5I%252B77DtQzG9t3AOhnbISUNp7wUmhnZWQrdxdealDRyh1609ovpIYCF9jegaE395IxUJUvpCY46J5TxrnBtDtkA1KY2f5hjmQxVAMCdpDLn%252FtA1KAyXkZow%253D%253D&width=800&format=webp&quality=100",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2320,
        1984
      ],
      "id": "89605eed-70d9-4903-bedc-bb8330920bc6",
      "name": "MainImage Convert_13"
    },
    {
      "parameters": {
        "content": "## 실패작",
        "height": 624,
        "width": 2048
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        944,
        1088
      ],
      "id": "6db795fb-026b-426b-9cbf-7f5a7da811d3",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## 시작지점 끝지점 이어져있는 Flow\n",
        "height": 512,
        "width": 1840
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        960,
        1760
      ],
      "id": "a78739e9-b711-4b1d-8a2f-43c32fee883b",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## 이미지 URL 하나로 이미지 File로 합치기",
        "height": 416,
        "width": 1200,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -528,
        2400
      ],
      "id": "c180c67f-c0c2-4205-a862-a0477ca33476",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "## 이미지 URL입력",
        "height": 208,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        2400
      ],
      "id": "15f27ad6-0cdc-495d-a298-c7006cd013a1",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "=당신은 쇼핑몰 상세이미지 분석 전문가입니다.\n세로로 긴 상세이미지를 분석하여 요청된 영역의 픽셀 좌표를 정확히 추출합니다.\n\n## 최우선 규칙 (절대 위반 금지)\n1. **이미지 잘림 금지**: 모든 영역의 시작과 끝에서 제품 사진이나 텍스트가 1px이라도 잘리면 안 됨\n2. **완전한 요소만 포함**: 사진은 반드시 전체가 보여야 하며, 일부만 보이는 사진은 해당 영역에서 제외\n3. **경계 여유 확보**: 확실하지 않으면 여유 있게 잘라서 콘텐츠가 잘리지 않도록 함\n4. **텍스트 타이틀 포함**: 영역이 타이틀(제목)로 시작하면 반드시 타이틀부터 포함\n\n---\n\n## 분석할 영역\n\n### 1. brand_description_section (브랜드 설명 영역)\n**포함 항목:**\n- 브랜드 로고 (예: klache, 브랜드명)\n- 제품명\n- 가격 정보\n- \"Color View\" 등 컬러 옵션 표시 영역\n- 컬러 선택 버튼/아이콘\n\n**제외 항목:**\n- 모든 제품 사진 (썸네일 포함)\n- 착용샷, 연출샷\n\n**경계 규칙:**\n- 시작: 이미지 최상단 또는 브랜드 로고 시작점\n- 종료: 컬러 옵션 표시(Color View) 영역이 완전히 끝난 직후\n- 종료점은 첫 번째 제품 사진이 시작되기 전이어야 함\n\n---\n\n### 2. product_image_section (제품 사진 영역)\n**이 영역은 현재 상세이미지에서 탐지하기 어려울 수 있음**\n\n**포함 조건 (모두 충족해야 함):**\n- 순수 단색 배경 (흰색, 연한 회색 등)\n- 제품만 단독으로 존재 (소품 없음)\n- 텍스트 없음\n- 사진 전체가 보임 (잘린 사진 제외)\n\n**제외 항목:**\n- 소품이 있는 사진 (책, 잡지, 꽃, 가구 등)\n- 배경에 공간이 보이는 사진 (방, 스튜디오 등)\n- 행거/옷걸이에 걸린 연출샷\n- 모델 착용샷\n- 텍스트가 포함된 영역\n- \"Cream\", \"Gray\" 등 컬러명 텍스트\n\n**경계 규칙:**\n- 시작: 단색 배경 제품 단독 사진의 상단 경계 (사진 위 여백 포함)\n- 종료: 마지막 단색 배경 제품 사진의 하단 경계 (사진 아래 여백 포함)\n- 조건에 맞는 사진이 없으면 null 반환\n\n---\n\n### 3. detail_cut_section (디테일컷 영역)\n**포함 항목:**\n- \"Point Details\", \"Detail\" 등의 타이틀 텍스트 (있는 경우 반드시 포함)\n- 제품 부분 확대/클로즈업 사진 (단추, 자수, 라벨, 소재 질감 등)\n- 여러 장의 작은 디테일 사진이 그리드로 배치된 영역\n\n**식별 기준:**\n- 제품 전체가 아닌 일부분만 확대\n- 보통 2x2 또는 여러 장이 나란히 배치\n- 소재의 질감, 마감 품질을 보여주는 목적\n\n**제외 항목:**\n- 제품 전신 사진\n- 착용샷/연출샷\n- \"Description\" 텍스트 및 제품 설명 문단\n- \"Fabric Information\", \"Size Information\" 등 정보 영역\n\n**경계 규칙:**\n- 시작: \"Point Details\" 또는 \"Detail\" 타이틀 텍스트 상단 (타이틀 없으면 첫 디테일 사진 상단)\n- 종료: 마지막 디테일 사진이 완전히 끝난 직후\n- 종료점은 \"Fabric Information\" 등 정보 타이틀 시작 전이어야 함\n- 디테일 사진이 잘리지 않도록 충분한 여백 확보\n\n---\n\n### 4. info_section (판매정보 영역)\n**포함 항목:**\n- \"Fabric Information\" 타이틀 및 소재 사진/정보\n- \"Size Information\" 타이틀 및 사이즈표\n- \"Product Information\" 타이틀 및 제품 스펙표\n- \"Notice\" 타이틀 및 공지사항\n- 배송 정보, 교환/반품 안내\n- 사이즈 도식화 (흑백 선 일러스트)\n\n**식별 기준:**\n- \"Information\", \"Notice\" 등의 영문 타이틀로 시작\n- 표(table) 형태의 데이터\n- 텍스트 위주 구성\n\n**제외 항목:**\n- 컬러 제품 사진 (소재 참고용 사진은 포함 가능)\n- 디테일컷 사진\n\n**경계 규칙:**\n- 시작: \"Fabric Information\" 또는 첫 번째 정보 타이틀의 상단\n- 종료: 이미지 최하단\n- 타이틀 텍스트가 잘리지 않도록 시작점 여유 확보\n\n---\n\n## 경계 설정 체크리스트 (각 영역별 필수 확인)\n- [ ] 시작점에 잘린 이미지가 있는가? → 있으면 시작점을 위로 이동\n- [ ] 시작점에 잘린 텍스트가 있는가? → 있으면 시작점을 위로 이동\n- [ ] 종료점에 잘린 이미지가 있는가? → 있으면 종료점을 아래로 이동\n- [ ] 종료점에 잘린 텍스트가 있는가? → 있으면 종료점을 아래로 이동\n- [ ] 타이틀이 있는 영역인데 타이틀이 빠졌는가? → 타이틀 포함하도록 시작점 조정\n\n---\n\n## 출력 규칙\n1. 좌표는 정수(px)로 반환\n2. 영역이 존재하지 않거나 조건을 만족하는 콘텐츠가 없으면 null 반환\n3. 추가 설명 없이 JSON만 반환\n\n## 출력 형식\n\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": {\n    \"brand_description_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"product_image_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"detail_cut_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"info_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null\n  }\n}",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        1072,
        2464
      ],
      "id": "ddfa450d-19b3-4623-865a-13ff19a6929f",
      "name": "Analyze image1",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "ImageURL",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ImageURL_1",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DgEkKV6sXnOiqFUn%252Bp945NydZ%252BMxo5%252B%252BCcenV4eHhnJ3x4wntcBJj2NtMBK6T5sgSbkEkEjyfnVXErgfDWC%252BxE9TgP5rQXpfDSdbR7siz5o%252FUfqbUg%252FgPQElA0ppuH74kH8radbl4tSV6bkZGhHOPc%252BMyKpMhunPMXehnLaOpJms%252BwEgGDov2S%252BXFdBhrVVeDssv2%252FZZOkO3moZth5LA6CMqVNTDMt3mvU1SAv9SJj6cL0WvuC9A1tOZZs1nWy2PKjyGfyTtv7yrxtMsc12IcnTp5uGTUwbJcsBa3prCgCEYH0%252FMzaKtt%252ByhqucoKHqQ98VefeBYgYvvuQPxLljUI%252FA%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_2",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DJkar0mBDdrc0q0URN2utCKTAfExoP0cnHL1IVLf5qbD2lTnszQqFUX1iZVi9s7tHUpFJmvzQM5lyQ8ZByTlrNl21xZNwaw%252BFe6vMniniF%252BEVjtYa%252B9mRPdwLMQ4nfHN5LN1kBAPoBqNtlgs4ffx41fdrLzfr%252Br9xrjaSix4zkxq5DDM5HF2QFWs4Qjpx%252BO5n2Z%252FjSExxl%252F65WsqL9cHet7TfPLDml8Zzox%252Bj19H7CCGYDxmHJGK5zXteoYDXHolWjSFMD9bgllMZZwOIX9jevxxFLeq9F1Or15aVUQxUATgkQOjdS2wEk1CUzlG5EGWhZmIZvXZ3doH5cH27IGoOkw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_3",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DiVrSM2199i%252FvfHEe%252BsnyThfr76rvg5rau3AE7tiBI7lvjvbsuz1RqQNcpbLOsbS%252B1845%252BcJXJ9woaQ3K%252B8m5xQIT3IZ%252FnjGash6ABr%252BvwdfKR3HxNsmEewXgjR5yMnNKz6i2Q7cqwsZ7wiwo%252Fc%252Fbw94iwekU%252ByU%252FELFcazB6Cegc53nsCgnYdO2Y9rXquunZKuVGwSA3FJAoPf6pnbFW1eUpFiKwid8QBGXo70qAReVTGsjKzVlvD%252BMCa93Rf%252BTmb%252FmqhsZO3nDYPCVFpC2QQFm0m%252BZdUVwYAYU4GZHPqWaT09jft03eCOWe4xm2A2%252BGYBCdv4kgBulJaXt3i%252Bwhbw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_4",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DbnqpSSsxIXGE5UI1nxtb8KMeZZQdRd7UEMy2WW60cHUGFRy9kry0UImshKeacoNkmXveQK0LyE7CXswjuNbvv6sbCLaAq9tJxm8SCb4ivUO5KIYDiACrrKYxsnIkJOOI1WJ3mQIgEBd569ZuWtCRcIRCW1NUCTewbQs5grwKdPL5KHGfrWouqYD3cjJ0RUeNrx461uh9M6b3lx5JQCWJghudxd3WN%252Fpaa%252F7EaXO5NnOTdNRoQj6PN%252Bvuc%252Fc4stJ5qZEQ6jhNFnZR2JF4PTPYyJkG%252Flz5EnkLeouBNlKdrifCq4xBkqjwV%252F5y%252FO983RRrOZqK0VsAmKIbP78vlIKGQg%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_5",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQaP4z9XdQJb9YguLzHLbVbwHaPqZTNTxZyt78ZFIUpbvujJ%252BTs5h%252FelsvABXLkm%252F%252B8FkB1dfr9qxd00pJ8LXkW4VQkemzQT9ftZq9Iw3u5xnXN9tRWaK%252FOMYJz6%252FYYqsRftCMxsIx4sZk1F18PIwewwHjuM9c1kaRINJp0nLY6NystjCNCMyWFnI9yzOXp9pWKd6V7YBrcaSXrY6flbKw1djzsvow3sP5I%252B77DtQzG9t3AOhnbISUNp7wUmhnZWQrdxdealDRyh1609ovpIYCF9jegaE395IxUJUvpCY46J5TxrnBtDtkA1KY2f5hjmQxVAMCdpDLn%252FtA1KAyXkZow%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -704,
        2480
      ],
      "id": "c0743393-084d-4072-b37e-83c4ff350b68",
      "name": "Input ImageURL",
      "webhookId": "04749819-404a-44db-a084-81a969bef931"
    },
    {
      "parameters": {
        "jsCode": "// 입력 데이터 받기\nconst item = $input.all()[0].json;\n\n// URL 패턴이 \"ImageURL_숫자\" 형태인 항목만 추출\nconst urls = Object.keys(item)\n  .filter(key => key.startsWith(\"ImageURL_\"))\n  .map(key => ({\n    index: parseInt(key.replace(\"ImageURL_\", \"\")), // 번호 추출\n    key,\n    url: item[key]\n  }))\n  .sort((a, b) => a.index - b.index); // 번호 순 정렬\n\n// 각 URL을 개별 아이템으로 반환\nreturn urls.map(obj => ({\n  json: obj\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -496,
        2480
      ],
      "id": "c21571ec-28db-4757-ac07-28933b148a21",
      "name": "Make URL Array"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -288,
        2480
      ],
      "id": "967ee6d5-8a93-46eb-bba1-bd18f2608f7a",
      "name": "Loop Over URLs"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "={{ $json.key }}"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        0,
        2624
      ],
      "id": "574a7c33-a959-4770-905f-79886c7100ce",
      "name": "ImageURL To File"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "={{ $json.key }}",
        "destinationKey": "={{ $json.key }}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        192,
        2624
      ],
      "id": "87c29005-4da3-41c8-bd95-e552e5cfbd1d",
      "name": "File To Base64"
    },
    {
      "parameters": {
        "jsCode": "let merged = {};\n\nfor (const item of items) {\n  Object.assign(merged, item.json);\n}\n\nreturn [\n  {\n    json: merged\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        48,
        2464
      ],
      "id": "9b46a802-a487-4efc-9e80-e706ea8a2caf",
      "name": "Make Base64 Array"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "import base64\nfrom PIL import Image\nfrom io import BytesIO\n\nimages_b64 = [\n  _input.first().json.ImageURL_1,\n  _input.first().json.ImageURL_2,\n  _input.first().json.ImageURL_3,\n  _input.first().json.ImageURL_4,\n  _input.first().json.ImageURL_5,\n]\n\n# base64 → PIL Image\nimages = []\nfor b64 in images_b64:\n    if b64:\n        data = base64.b64decode(b64.split(',')[-1])\n        images.append(Image.open(BytesIO(data)))\n\n# 크기 계산\nmax_width = max(img.width for img in images)\ntotal_height = sum(img.height for img in images)\n\n# 합치기\ncombined = Image.new('RGB', (max_width, total_height), 'white')\ny_offset = 0\nfor img in images:\n    combined.paste(img, (0, y_offset))\n    y_offset += img.height\n\n# 원본 사이즈 읽기 (재변환 필요 없음!)\norig_w, orig_h = combined.size\n\n# target 높이\ntarget_h = 8000\n\n# 비율에 맞는 width 계산\ntarget_w = int(orig_w * (target_h / orig_h))\n\n# base64로 반환\nbuffer = BytesIO()\ncombined.save(buffer, format='JPEG', quality=90)\nresult_b64 = base64.b64encode(buffer.getvalue()).decode()\n\nreturn {\n    \"resize_width\": target_w,\n    \"resize_height\": target_h,\n    \"combinedImage\": result_b64\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        304,
        2464
      ],
      "id": "5e71893c-580d-4d2a-b9f6-470b9ea965b5",
      "name": "Attach Base64"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "combinedImage",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        528,
        2464
      ],
      "id": "0e699aad-2171-403a-9633-7398b6c9f7a1",
      "name": "Convert Base64 To File"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base64').item.json.resize_width }}",
        "height": "={{ $('Attach Base64').item.json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        784,
        2464
      ],
      "id": "5a410155-0906-4082-a594-19de4da658f8",
      "name": "Resize Image"
    },
    {
      "parameters": {
        "content": "## Height 8000으로 조정",
        "height": 240,
        "width": 272,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        704,
        2400
      ],
      "id": "dce97086-b9d2-4be2-80c6-68661d5c77a3",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "content": "## Claud로 분석",
        "height": 240,
        "width": 400,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1008,
        2400
      ],
      "id": "165c7552-994e-43d7-b870-8deaa526c369",
      "name": "Sticky Note10"
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 적용 함수 (null-safe)\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections는 object → array 로 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 자동 제외하고 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1264,
        2464
      ],
      "id": "fba8fca4-8b3a-43ab-b3ab-069bb3a2ed89",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2800,
        2864
      ],
      "id": "5e0d3f55-5bdc-4dd9-b7e4-34bcf3e8c586",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items').item.json.width }}",
        "height": "={{ $('Loop Over Items').item.json.height }}",
        "positionX": "={{ $('Loop Over Items').item.json.x }}",
        "positionY": "={{ $('Loop Over Items').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        3504,
        3040
      ],
      "id": "c6cfd9e4-5a40-43f0-8107-de9cd459b299",
      "name": "Edit Image8"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3216,
        2848
      ],
      "id": "b4b1134e-8a62-4ec0-aeda-ad61bdc8a213",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2672,
        2800
      ],
      "id": "330651e5-b914-41ff-a020-7e4d77ea113f",
      "name": "Sticky Note11"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base64').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3008,
        2960
      ],
      "id": "67f75064-1656-45bf-9c1e-5fddfc3c8a2d",
      "name": "Code in JavaScript5"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "height": 8000,
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2464,
        1984
      ],
      "id": "16d7bbaf-a5d2-4c0e-884f-76462e095121",
      "name": "Edit Image7"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (JavaScript)\n\n// 각 item에서 필요한 key만 추출\nconst cleaned = items.map(item => {\n  const s = item.json;\n  return {\n    section_name: s.section_name,\n    x: s.x,\n    y: s.y,\n    width: s.width,\n    height: s.height\n  };\n});\n\n// 하나의 item으로 묶어서 반환\nreturn [\n  {\n    json: {\n      sections: cleaned\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1536,
        2464
      ],
      "id": "930efca3-6ee5-4ed6-8eed-a7e5908998c3",
      "name": "Code in JavaScript6"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base64').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base64').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        3344,
        3040
      ],
      "id": "e2cdec4f-8fb8-484b-9d3e-3b26e7a705a6",
      "name": "Edit Image9"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3184,
        3040
      ],
      "id": "5fde0fdf-2362-4734-a9a8-c2058dc4cf66",
      "name": "Convert Base64 To File1"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base64').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1744,
        2464
      ],
      "id": "897687b3-ca59-44dd-a698-51722017a2c0",
      "name": "Code in JavaScript7"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base64').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base64').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2080,
        2464
      ],
      "id": "6e20406b-63a4-463c-b209-c701075e3e2a",
      "name": "Edit Image10"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        1920,
        2464
      ],
      "id": "6df62d96-0de8-46dd-ac63-98be031f5685",
      "name": "Convert Base64 To File2"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "=당신은 쇼핑몰 상세이미지 분석 전문가입니다.\n아래에 제공된 좌표 데이터는 1차 분석 결과이며, \n당신의 임무는 이 좌표들이 “정확한 경계로 잘 설정되었는지”를 검증하고 필요한 경우 보정하는 것입니다.\n\n===============================================================\n📌 최우선 절대 규칙 (재검증 시 반드시 준수)\n1. 이미지 잘림 금지  \n   - 경계에 사진·텍스트가 1px이라도 잘려 있으면 해당 영역의 x,y,width,height를 조정해야 함.\n2. 완전한 요소만 포함  \n   - 사진이 일부만 보이면 해당 사진은 포함하지 않고 경계를 조정.\n3. 경계 여유 확보  \n   - 확실하지 않은 경우 사진·텍스트가 잘리지 않도록 상하단을 여유 있게 잡아야 함.\n4. 타이틀 포함  \n   - 영역이 타이틀로 시작하는 경우 타이틀 텍스트의 상단부터 포함해야 함.\n\n===============================================================\n📌 검증해야 할 내용\n아래 제공된 영역 좌표들이 실제 이미지 상에서 정확히 다음 조건을 충족하는지 분석하십시오:\n\n### 1. brand_description_section\n- 브랜드 로고, 제품명, 가격, Color View/컬러 옵션 영역이 모두 포함되어야 함.\n- 어떤 형태의 제품 사진도 포함되면 안 됨.\n- 마지막 컬러 옵션 표시가 끝난 직후까지 포함해야 함.\n→ 제품 사진이 포함되어 있거나, 컬러 옵션이 잘려 있으면 수정.\n\n### 2. product_image_section\n- 순수 단색 배경 + 제품 단독 사진만 포함.\n- 텍스트 포함되면 안 됨.\n- 사진이 잘리면 안 됨.\n- 조건에 맞는 사진이 1장도 없을 경우 null 반환.\n\n### 3. detail_cut_section\n- 디테일 타이틀(Detail, Point Details...)이 있다면 반드시 포함.\n- 확대된 제품 부분 사진만 포함.\n- 정보 영역(Fabric Information 등)이 포함되면 안 됨.\n- 디테일 사진이 잘리면 경계 보정.\n\n### 4. info_section\n- “Fabric Information”, “Size Information”, “Notice”, “Product Information” 등의 타이틀이 포함된 텍스트·표 영역.\n- 시작은 첫 타이틀 상단.\n- 종료는 이미지 최하단.\n- 디테일컷 사진이 포함되면 안 됨.\n\n===============================================================\n📌 입력 데이터\n이미지 전체 + 아래의 1차 분석 좌표(JSON)\n\n1차 분석 좌표\n{{ $('Analyze image1').all()[0].json.content[0].text }}\n\n\n당신은 다음을 수행해야 합니다:\n1. 각 영역이 규칙에 맞는지 실제 이미지와 비교하여 검증  \n2. 잘못된 경우 정확한 좌표로 재보정  \n3. 문제 없으면 그대로 반환  \n4. description 없이 오직 JSON만 반환\n\n===============================================================\n📤 출력 형식 (반드시 동일)\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": {\n    \"brand_description_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"product_image_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"detail_cut_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"info_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null\n  }\n}\n",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        2256,
        2464
      ],
      "id": "a698fafd-4178-415f-bb1d-19898e16f3f9",
      "name": "Analyze image2",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 적용 함수 (null-safe)\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections는 object → array 로 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 자동 제외하고 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2512,
        2464
      ],
      "id": "6bf17b4b-fceb-4878-b0c0-8cd32d0a1ac7",
      "name": "Code in JavaScript8"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1568,
        2880
      ],
      "id": "4889ce9a-4936-4d50-8f8b-a0241ab6453a",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items3').item.json.width }}",
        "height": "={{ $('Loop Over Items3').item.json.height }}",
        "positionX": "={{ $('Loop Over Items3').item.json.x }}",
        "positionY": "={{ $('Loop Over Items3').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2272,
        3056
      ],
      "id": "f72324ff-d4ec-4c24-b2f3-19013174c246",
      "name": "Edit Image11"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1984,
        2864
      ],
      "id": "05432fa1-713c-410b-9e6b-45adc24c1433",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1472,
        2816
      ],
      "id": "7cfb4627-5daa-4b15-8b72-27823c390f5b",
      "name": "Sticky Note13"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base64').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1776,
        2976
      ],
      "id": "f0c881c2-3c72-4d29-bf41-d40a62ae8085",
      "name": "Code in JavaScript9"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base64').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base64').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2112,
        3056
      ],
      "id": "de27493f-3ac4-4429-87db-361e1651739c",
      "name": "Edit Image12"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        1952,
        3056
      ],
      "id": "4111f7d9-d8d9-45eb-b649-b9497a0aca07",
      "name": "Convert Base64 To File3"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (JavaScript)\n\n// 각 item에서 필요한 key만 추출\nconst cleaned = items.map(item => {\n  const s = item.json;\n  return {\n    section_name: s.section_name,\n    x: s.x,\n    y: s.y,\n    width: s.width,\n    height: s.height\n  };\n});\n\n// 하나의 item으로 묶어서 반환\nreturn [\n  {\n    json: {\n      sections: cleaned\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2816,
        2464
      ],
      "id": "dcd192a1-ef23-4239-a015-79f4d4469ce4",
      "name": "Code in JavaScript10"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base64').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3024,
        2464
      ],
      "id": "6963d4b1-4fc4-4641-ae86-b481b5da231e",
      "name": "Code in JavaScript11"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base64').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base64').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        3360,
        2464
      ],
      "id": "308f27c4-6826-4942-8923-e8b70ed1fb3c",
      "name": "Edit Image13"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3200,
        2464
      ],
      "id": "98823217-72dc-4902-bea2-b471ecce11e7",
      "name": "Convert Base64 To File4"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "=당신은 쇼핑몰 상세이미지 분석 전문가입니다.\n아래에 제공된 좌표 데이터는 2차 분석 결과이며, \n당신의 임무는 이 좌표들이 “정확한 경계로 잘 설정되었는지”를 검증하고 필요한 경우 보정하는 것입니다.\n\n===============================================================\n📌 최우선 절대 규칙 (재검증 시 반드시 준수)\n1. 이미지 잘림 금지  \n   - 경계에 사진·텍스트가 1px이라도 잘려 있으면 해당 영역의 x,y,width,height를 조정해야 함.\n2. 완전한 요소만 포함  \n   - 사진이 일부만 보이면 해당 사진은 포함하지 않고 경계를 조정.\n3. 경계 여유 확보  \n   - 확실하지 않은 경우 사진·텍스트가 잘리지 않도록 상하단을 여유 있게 잡아야 함.\n4. 타이틀 포함  \n   - 영역이 타이틀로 시작하는 경우 타이틀 텍스트의 상단부터 포함해야 함.\n\n===============================================================\n📌 검증해야 할 내용\n아래 제공된 영역 좌표들이 실제 이미지 상에서 정확히 다음 조건을 충족하는지 분석하십시오:\n\n### 1. brand_description_section\n- 브랜드 로고, 제품명, 가격, Color View/컬러 옵션 영역이 모두 포함되어야 함.\n- 어떤 형태의 제품 사진도 포함되면 안 됨.\n- 마지막 컬러 옵션 표시가 끝난 직후까지 포함해야 함.\n→ 제품 사진이 포함되어 있거나, 컬러 옵션이 잘려 있으면 수정.\n\n### 2. product_image_section\n- 순수 단색 배경 + 제품 단독 사진만 포함.\n- 텍스트 포함되면 안 됨.\n- 사진이 잘리면 안 됨.\n- 조건에 맞는 사진이 1장도 없을 경우 null 반환.\n\n### 3. detail_cut_section\n- 디테일 타이틀(Detail, Point Details...)이 있다면 반드시 포함.\n- 확대된 제품 부분 사진만 포함.\n- 정보 영역(Fabric Information 등)이 포함되면 안 됨.\n- 디테일 사진이 잘리면 경계 보정.\n\n### 4. info_section\n- “Fabric Information”, “Size Information”, “Notice”, “Product Information” 등의 타이틀이 포함된 텍스트·표 영역.\n- 시작은 첫 타이틀 상단.\n- 종료는 이미지 최하단.\n- 디테일컷 사진이 포함되면 안 됨.\n\n===============================================================\n📌 입력 데이터\n이미지 전체 + 아래의 2차 분석 좌표(JSON)\n\n2차 분석 좌표\n{{ $('Analyze image2').all()[0].json.content[0].text }}\n\n당신은 다음을 수행해야 합니다:\n1. 각 영역이 규칙에 맞는지 실제 이미지와 비교하여 검증  \n2. 잘못된 경우 정확한 좌표로 재보정  \n3. 문제 없으면 그대로 반환  \n4. description 없이 오직 JSON만 반환\n\n===============================================================\n📤 출력 형식 (반드시 동일)\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": {\n    \"brand_description_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"product_image_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"detail_cut_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"info_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null\n  }\n}\n",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        3536,
        2464
      ],
      "id": "dc2d93fc-dc26-4d93-b3c2-0f8dbb1cd828",
      "name": "Analyze image3",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 적용 함수 (null-safe)\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections는 object → array 로 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 자동 제외하고 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3792,
        2464
      ],
      "id": "3293815c-4e76-4184-8ed4-70b465a2f6f9",
      "name": "Code in JavaScript12"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        4144,
        2688
      ],
      "id": "a794ec7a-b86d-42bd-a4d2-677d48782780",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items4').item.json.width }}",
        "height": "={{ $('Loop Over Items4').item.json.height }}",
        "positionX": "={{ $('Loop Over Items4').item.json.x }}",
        "positionY": "={{ $('Loop Over Items4').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        4848,
        2864
      ],
      "id": "a89cdecf-6465-4f1f-9f2e-113cb33721e2",
      "name": "Edit Image14"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4560,
        2672
      ],
      "id": "c085d21b-3593-4e83-a240-d7dace1ee04f",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4016,
        2624
      ],
      "id": "9f4f2f08-4146-4aba-806a-4aaef0d93e33",
      "name": "Sticky Note14"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base64').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4352,
        2784
      ],
      "id": "bc23c090-e7b0-455a-99b7-3d794ebe72d3",
      "name": "Code in JavaScript13"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base64').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base64').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        4688,
        2864
      ],
      "id": "a8608b5d-ba7e-4f2b-9c45-e84c0854bac3",
      "name": "Edit Image15"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        4528,
        2864
      ],
      "id": "3e602ab6-caac-4f4e-9e75-2d0a44f66bde",
      "name": "Convert Base64 To File5"
    },
    {
      "parameters": {
        "content": "## 이미지 URL 하나로 이미지 File로 합치기",
        "height": 416,
        "width": 1200,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -512,
        3856
      ],
      "id": "35bdca0c-86c0-4e0c-9f68-4a5358b648bb",
      "name": "Sticky Note12"
    },
    {
      "parameters": {
        "content": "## 이미지 URL입력",
        "height": 208,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -784,
        3856
      ],
      "id": "d24f7695-bb0f-4f73-9747-b1a3867d0753",
      "name": "Sticky Note15"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "=당신은 *쇼핑몰 상세페이지 이미지(세로형)*를 4개의 주요 영역으로 정확하게 분리하는 전문 비전 분석 모델입니다.\n이미지 속 콘텐츠(텍스트, 제품 사진, 배경 패턴, 구성 방식)를 정밀하게 분석하여 아래 네 가지 영역의 **대략적인 bounding box 좌표(x, y, width, height)**를 추출하십시오.\n\n절대 준수해야 할 분석 원칙:\n\n텍스트와 사진이 1px이라도 잘려 들어가면 안 됨.\n영역 분리는 반드시 자연스러운 ‘시작–종료 지점’을 기준으로 함.\n요소가 완전히 포함된 상태로만 영역을 구성.\n애매하면 여유 있게(cushion) 위아래로 여백 포함.\n영역 간 중복 불가.\n이미지가 없는 영역은 null로 반환.\n\n---\n\n🎯 **1. brand_description_section (브랜드 & 상단 요약 영역)**\n\n📌 **특징 기반 분류 기준**\n- 상세페이지 가장 최상단에 위치\n- 브랜드 로고, 브랜드명(영문/국문), 제품명(Title), 가격 정보, 할인율\n- 컬러 옵션(동그라미 스와치, 색상칩, “Color View” 텍스트 포함)\n- 텍스트 비중이 높고 이미지 비중은 매우 적음\n- 제품 단독 사진이 시작되기 전에 완전히 종료됨\n\n📌 **포함해야 하는 범위**\n- 브랜드 로고 ~ 컬러 옵션 선택 영역 전체\n- 컬러 옵션이 있다면 반드시 해당 영역의 끝까지 포함\n- 그 아래 첫 번째 제품 단독 사진이 시작되기 직전까지\n\n📌 **완료 기준**\n위 조건을 모두 만족하는 영역을 하나의 bounding box로 제공  \n없다면 null\n\n---\n\n🎯 **2. product_image_section (제품 단독 컷 묶음)**\n\n📌 **특징 기반 분류 기준**\n- 배경이 흰색 또는 밝은 단색\n- 제품 단독 사진 only\n- 착용컷(모델 등장), 연출컷, 라이프스타일컷, 환경 배경 포함 사진 제외\n- 텍스트가 거의 없음(1px도 없어야 함)\n- 제품 이미지들이 세로로 길게 연속되는 경우가 많음\n\n📌 **지정 방식**\n- 조건을 충족하는 \"제품 단독컷\" 여러 개가 연속된 하나의 묶음이라면  \n  → 전체 묶음을 하나의 큰 사각형 영역으로 반환\n- 단독컷이 한 장도 없다면 → null\n\n📌 **포함 범위**\n- 첫 번째 단독컷 시작 지점  \n- 마지막 단독컷 종료 지점  \n- 가로폭은 전체 콘텐츠 가로폭 기준으로 설정\n\n---\n\n🎯 **3. detail_cut_section (제품 디테일 확대컷)**\n\n📌 **특징 기반 분류 기준**\n- Detail이라는 텍스트가 포함된 타이틀로 영역 시작.\n- 제품의 특정 부분(소재, 단추, 지퍼, 라벨, 봉제선 등)을 확대한 사진들\n- 보통 2x2 그리드, 세로 나열 등 여러 장의 디테일 이미지가 연속적으로 존재\n- 단독컷보다 더 가까운 확대 이미지\n- 텍스트 포함 거의 없음\n\n📌 **종료 기준**\n- 시작경계부터 분석하여 다른 타이틀 텍스트가 발견될 때 까지.\n\n📌 **포함 범위**\n- Detail 타이틀 영역 시작 / 디테일 컷들의 시작 ~ 다른 타이틀 텍스트의 상단부분까지\n- 디테일 컷이 아예 없다면 → null\n\n---\n\n🎯 **4. info_section (정보 텍스트 영역)**\n\n📌 **특징 기반 분류 기준**\n- 텍스트 중심 정보 영역\n- 주요 타이틀 예시:\n  - Fabric Information\n  - Size / Measurement\n  - Product Information\n  - Notice / Caution\n- 표(table), 정형화된 정보 레이아웃 포함\n- 작은 소재 이미지는 포함 가능(정보 제공 목적)\n- 주 피사체는 텍스트이며 사진은 거의 없음\n\n📌 **포함 범위**\n- 첫 정보 타이틀 시작 지점\n- 상세페이지 끝까지 전체 포함\n\n📌 없다면 null (거의 발생하지 않음)\n\n---\n\n📦 **출력 형식 (반드시 JSON ONLY)**  \n아래 형식을 그대로 유지하여 출력하십시오:\n\n```json\n{\n  \"original_image_size\": { \"width\": number, \"height\": number },\n  \"sections\": {\n    \"brand_description_section\": { \"x\": number, \"y\": number, \"width\": number, \"height\": number } | null,\n    \"product_image_section\": { \"x\": number, \"y\": number, \"width\": number, \"height\": number } | null,\n    \"detail_cut_section\": { \"x\": number, \"y\": number, \"width\": number, \"height\": number } | null,\n    \"info_section\": { \"x\": number, \"y\": number, \"width\": number, \"height\": number } | null\n  }\n}\n",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        1088,
        3920
      ],
      "id": "05d5110f-0312-4c0d-9321-4bca6c381540",
      "name": "Analyze image4",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "ImageURL",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ImageURL_1",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DgEkKV6sXnOiqFUn%252Bp945NydZ%252BMxo5%252B%252BCcenV4eHhnJ3x4wntcBJj2NtMBK6T5sgSbkEkEjyfnVXErgfDWC%252BxE9TgP5rQXpfDSdbR7siz5o%252FUfqbUg%252FgPQElA0ppuH74kH8radbl4tSV6bkZGhHOPc%252BMyKpMhunPMXehnLaOpJms%252BwEgGDov2S%252BXFdBhrVVeDssv2%252FZZOkO3moZth5LA6CMqVNTDMt3mvU1SAv9SJj6cL0WvuC9A1tOZZs1nWy2PKjyGfyTtv7yrxtMsc12IcnTp5uGTUwbJcsBa3prCgCEYH0%252FMzaKtt%252ByhqucoKHqQ98VefeBYgYvvuQPxLljUI%252FA%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_2",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DJkar0mBDdrc0q0URN2utCKTAfExoP0cnHL1IVLf5qbD2lTnszQqFUX1iZVi9s7tHUpFJmvzQM5lyQ8ZByTlrNl21xZNwaw%252BFe6vMniniF%252BEVjtYa%252B9mRPdwLMQ4nfHN5LN1kBAPoBqNtlgs4ffx41fdrLzfr%252Br9xrjaSix4zkxq5DDM5HF2QFWs4Qjpx%252BO5n2Z%252FjSExxl%252F65WsqL9cHet7TfPLDml8Zzox%252Bj19H7CCGYDxmHJGK5zXteoYDXHolWjSFMD9bgllMZZwOIX9jevxxFLeq9F1Or15aVUQxUATgkQOjdS2wEk1CUzlG5EGWhZmIZvXZ3doH5cH27IGoOkw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_3",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DiVrSM2199i%252FvfHEe%252BsnyThfr76rvg5rau3AE7tiBI7lvjvbsuz1RqQNcpbLOsbS%252B1845%252BcJXJ9woaQ3K%252B8m5xQIT3IZ%252FnjGash6ABr%252BvwdfKR3HxNsmEewXgjR5yMnNKz6i2Q7cqwsZ7wiwo%252Fc%252Fbw94iwekU%252ByU%252FELFcazB6Cegc53nsCgnYdO2Y9rXquunZKuVGwSA3FJAoPf6pnbFW1eUpFiKwid8QBGXo70qAReVTGsjKzVlvD%252BMCa93Rf%252BTmb%252FmqhsZO3nDYPCVFpC2QQFm0m%252BZdUVwYAYU4GZHPqWaT09jft03eCOWe4xm2A2%252BGYBCdv4kgBulJaXt3i%252Bwhbw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_4",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DbnqpSSsxIXGE5UI1nxtb8KMeZZQdRd7UEMy2WW60cHUGFRy9kry0UImshKeacoNkmXveQK0LyE7CXswjuNbvv6sbCLaAq9tJxm8SCb4ivUO5KIYDiACrrKYxsnIkJOOI1WJ3mQIgEBd569ZuWtCRcIRCW1NUCTewbQs5grwKdPL5KHGfrWouqYD3cjJ0RUeNrx461uh9M6b3lx5JQCWJghudxd3WN%252Fpaa%252F7EaXO5NnOTdNRoQj6PN%252Bvuc%252Fc4stJ5qZEQ6jhNFnZR2JF4PTPYyJkG%252Flz5EnkLeouBNlKdrifCq4xBkqjwV%252F5y%252FO983RRrOZqK0VsAmKIbP78vlIKGQg%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_5",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQaP4z9XdQJb9YguLzHLbVbwHaPqZTNTxZyt78ZFIUpbvujJ%252BTs5h%252FelsvABXLkm%252F%252B8FkB1dfr9qxd00pJ8LXkW4VQkemzQT9ftZq9Iw3u5xnXN9tRWaK%252FOMYJz6%252FYYqsRftCMxsIx4sZk1F18PIwewwHjuM9c1kaRINJp0nLY6NystjCNCMyWFnI9yzOXp9pWKd6V7YBrcaSXrY6flbKw1djzsvow3sP5I%252B77DtQzG9t3AOhnbISUNp7wUmhnZWQrdxdealDRyh1609ovpIYCF9jegaE395IxUJUvpCY46J5TxrnBtDtkA1KY2f5hjmQxVAMCdpDLn%252FtA1KAyXkZow%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -688,
        3936
      ],
      "id": "5b4e7651-7a4c-40b3-8070-c31b2f09d10f",
      "name": "Input ImageURL1",
      "webhookId": "553a2f36-607a-4246-872b-dc434d403c49"
    },
    {
      "parameters": {
        "jsCode": "// 입력 데이터 받기\nconst item = $input.all()[0].json;\n\n// URL 패턴이 \"ImageURL_숫자\" 형태인 항목만 추출\nconst urls = Object.keys(item)\n  .filter(key => key.startsWith(\"ImageURL_\"))\n  .map(key => ({\n    index: parseInt(key.replace(\"ImageURL_\", \"\")), // 번호 추출\n    key,\n    url: item[key]\n  }))\n  .sort((a, b) => a.index - b.index); // 번호 순 정렬\n\n// 각 URL을 개별 아이템으로 반환\nreturn urls.map(obj => ({\n  json: obj\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -480,
        3936
      ],
      "id": "e0f97aab-0bdd-4e22-b277-37ea196fad6c",
      "name": "Make URL Array1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -272,
        3936
      ],
      "id": "6072aa45-8e1e-4ad3-a376-2d2926517bff",
      "name": "Loop Over URLs1"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "={{ $json.key }}"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        16,
        4080
      ],
      "id": "fcb15a85-f745-4e2f-a24a-1cc4576dc31b",
      "name": "ImageURL To File1"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "={{ $json.key }}",
        "destinationKey": "={{ $json.key }}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        208,
        4080
      ],
      "id": "1a5f3395-eb99-420c-a0a9-69d6894e1a82",
      "name": "File To Base"
    },
    {
      "parameters": {
        "jsCode": "let merged = {};\n\nfor (const item of items) {\n  Object.assign(merged, item.json);\n}\n\nreturn [\n  {\n    json: merged\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        64,
        3920
      ],
      "id": "6e7d06b1-a97f-4947-9765-31e007d0af24",
      "name": "Make Base64 Array1"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "import base64\nfrom PIL import Image\nfrom io import BytesIO\n\nimages_b64 = [\n  _input.first().json.ImageURL_1,\n  _input.first().json.ImageURL_2,\n  _input.first().json.ImageURL_3,\n  _input.first().json.ImageURL_4,\n  _input.first().json.ImageURL_5,\n]\n\n# base64 → PIL Image\nimages = []\nfor b64 in images_b64:\n    if b64:\n        data = base64.b64decode(b64.split(',')[-1])\n        images.append(Image.open(BytesIO(data)))\n\n# 크기 계산\nmax_width = max(img.width for img in images)\ntotal_height = sum(img.height for img in images)\n\n# 합치기\ncombined = Image.new('RGB', (max_width, total_height), 'white')\ny_offset = 0\nfor img in images:\n    combined.paste(img, (0, y_offset))\n    y_offset += img.height\n\n# 원본 사이즈 읽기 (재변환 필요 없음!)\norig_w, orig_h = combined.size\n\n# target 높이\ntarget_h = 8000\n\n# 비율에 맞는 width 계산\ntarget_w = int(orig_w * (target_h / orig_h))\n\n# base64로 반환\nbuffer = BytesIO()\ncombined.save(buffer, format='JPEG', quality=90)\nresult_b64 = base64.b64encode(buffer.getvalue()).decode()\n\nreturn {\n    \"resize_width\": target_w,\n    \"resize_height\": target_h,\n    \"combinedImage\": result_b64\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        3920
      ],
      "id": "ae0a6ec3-56cb-4b44-9447-5f4b9c30a766",
      "name": "Attach Base"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "combinedImage",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        544,
        3920
      ],
      "id": "20b93f9a-85fb-4709-b81f-97bb294a6b23",
      "name": "Convert Base64 To File6"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base').item.json.resize_width }}",
        "height": "={{ $('Attach Base').item.json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        800,
        3920
      ],
      "id": "e4bc19d3-ca60-46be-9d4f-532e3ff86bf1",
      "name": "Resize Image1"
    },
    {
      "parameters": {
        "content": "## Height 8000으로 조정",
        "height": 240,
        "width": 272,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        720,
        3856
      ],
      "id": "89caaa58-d9b9-4a1f-802f-7fd6613efa69",
      "name": "Sticky Note16"
    },
    {
      "parameters": {
        "content": "## Claud로 분석",
        "height": 240,
        "width": 400,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1024,
        3856
      ],
      "id": "aa33e636-6156-4b52-a831-184fe7d856af",
      "name": "Sticky Note17"
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 적용 함수 (null-safe)\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections는 object → array 로 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 자동 제외하고 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1280,
        3920
      ],
      "id": "e05e3f6d-e859-42fd-9d5e-0b7d70fd4885",
      "name": "Code in JavaScript14"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2816,
        4320
      ],
      "id": "ee724bb8-ae9c-4986-88aa-b910b81086f7",
      "name": "Loop Over Items5"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items5').item.json.width }}",
        "height": "={{ $('Loop Over Items5').item.json.height }}",
        "positionX": "={{ $('Loop Over Items5').item.json.x }}",
        "positionY": "={{ $('Loop Over Items5').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        3520,
        4496
      ],
      "id": "61d544a5-ca3b-458a-a228-4fff95b8d992",
      "name": "Edit Image16"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3232,
        4304
      ],
      "id": "10ce9c2f-608b-42aa-888f-173c9764db66",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2688,
        4256
      ],
      "id": "2032b8af-3b21-4b70-a0ec-c02f141d7faa",
      "name": "Sticky Note18"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3024,
        4416
      ],
      "id": "bacc47e0-d495-4cd2-9e7e-a94671a4ae86",
      "name": "Code in JavaScript15"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (JavaScript)\n\n// 각 item에서 필요한 key만 추출\nconst cleaned = items.map(item => {\n  const s = item.json;\n  return {\n    section_name: s.section_name,\n    x: s.x,\n    y: s.y,\n    width: s.width,\n    height: s.height\n  };\n});\n\n// 하나의 item으로 묶어서 반환\nreturn [\n  {\n    json: {\n      sections: cleaned\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1552,
        3920
      ],
      "id": "4849fa7c-e63c-4bec-ab83-49604b5ebea5",
      "name": "Code in JavaScript16"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        3360,
        4496
      ],
      "id": "e196d887-3679-47df-9da6-97737849e4e7",
      "name": "Edit Image17"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3200,
        4496
      ],
      "id": "cff54fcf-b482-404a-98f8-5a4955e86f03",
      "name": "Convert Base64 To File7"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1760,
        3920
      ],
      "id": "ca2ebbf7-cf96-4108-8580-5cb9120dbd9d",
      "name": "Code in JavaScript17"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2096,
        3920
      ],
      "id": "44a73d1b-dc2e-44f3-bfe2-e89b43900d72",
      "name": "Edit Image18"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        1936,
        3920
      ],
      "id": "ae43aa58-063c-45cd-a661-09289a5156c6",
      "name": "Convert Base64 To File8"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "=당신은 쇼핑몰 상세이미지 분석 전문가입니다.  \n아래 제공된 좌표 데이터는 1차 분석 결과이며,  \n당신의 임무는 이 좌표들이 실제 이미지와 일치하는지 “정확하게 재검증하고, 필요 시 보정”하는 것입니다.\n\n- 1차 분석 좌표(JSON):  \n{{ $('Analyze image4').all()[0].json.content[0].text }}\n\n=====================================================================\n📌 **중요 안내 (반드시 준수)**\n입력된 1차 분석 좌표는 잘못되었을 가능성이 높으며,  \n당신은 이 좌표를 절대 신뢰하지 않습니다.  \n항상 **원본 이미지를 기준으로 판단**해야 합니다.\n\n모든 분석은 반드시 다음 순서로 수행하십시오:\n1) 이미지 전체 육안 검토  \n2) 해당 영역이 이미지에서 실제 충족되는지 확인  \n3) 충족되지 않으면 x,y,width,height 정확히 재설정  \n4) 문제 없으면 그대로 유지  \n이미지를 확인하지 않은 좌표 수정은 금지됩니다.\n\n=====================================================================\n📌 **절대 규칙 (4개 전부 필수)**\n1. **이미지 잘림 금지**  \n   - 사진 또는 텍스트가 1px이라도 잘리면 좌표를 반드시 수정해야 합니다.\n\n2. **완전한 요소만 포함**  \n   - 사진이 일부만 포함되면 해당 사진은 그 영역에서 제외하고 경계를 조정합니다.\n\n3. **경계 여유 확보**  \n   - 불확실한 경계는 콘텐츠가 잘리지 않도록 상/하/좌/우 모두 여유 있게 잡습니다.\n\n4. **타이틀 포함**  \n   - 영역이 타이틀(제목)로 시작하면 해당 타이틀의 상단에서 시작해야 합니다.\n\n5. **영역 종료**\n   - 영역을 분석하다가 다른 타이틀이 발견될 경우 발견된 타이틀 상단에서 영역종료.\n\n=====================================================================\n📌 **영역별 재검증 체크리스트**\n\n### 🔵 1. brand_description_section\n- 브랜드 로고 또는 브랜드명 포함?\n- 제품명 포함?\n- 가격 정보 포함?\n- Color View 또는 컬러 옵션(스와치, 선택 버튼 포함)이 모두 포함?\n- 마지막 컬러 옵션이 끝난 “직후”까지 포함?\n- 아래 제품 사진이 1px이라도 포함되면 즉시 경계 위로 조정\n\n### 🟣 2. product_image_section\n- 흰색/밝은 단색 배경 + 제품 단독 컷만 포함?\n- 텍스트 1px도 포함되면 안 됨\n- 사진이 잘리지 않았는지?\n- 여러 장의 제품 단독 컷이 연속되면 → **하나의 큰 영역**으로 묶어야 함\n- 조건에 맞는 사진이 하나도 없으면 null\n\n### 🟠 3. detail_cut_section\n- Detail / Point Detail 등 디테일 타이틀이 있다면 반드시 포함\n- 정보 영역(사이즈, 소재 등) 포함 금지\n- 디테일 사진이 잘리면 경계 보정\n\n### 🟢 4. info_section\n- \"Fabric Information\", \"Size Information”, “Notice”, “Product Information” 등 텍스트/표 영역만 포함\n- 시작은 첫 번째 정보 타이틀의 “상단”\n- 종료는 이미지 최하단\n- 디테일컷 사진 포함 금지\n\n\n=====================================================================\n📌 **출력 조건**\n- description, 설명, 코멘트, 마크다운 절대 포함 금지 (JSON만 출력)\n- x,y,width,height 모두 정수로 반환\n- null 가능\n\n=====================================================================\n📤 **최종 출력 형식 (반드시 동일)**\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": {\n    \"brand_description_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"product_image_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"detail_cut_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"info_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null\n  }\n}\n\n",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        2272,
        3920
      ],
      "id": "18ce8a44-4d6d-4881-a21e-62242fe183ed",
      "name": "Analyze image5",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 적용 함수 (null-safe)\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections는 object → array 로 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 자동 제외하고 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2528,
        3920
      ],
      "id": "b852f56c-8608-415b-8df5-836dfa457a24",
      "name": "Code in JavaScript18"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1584,
        4336
      ],
      "id": "bb1474c5-2e17-48a5-ba32-07078681dcf1",
      "name": "Loop Over Items6"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items6').item.json.width }}",
        "height": "={{ $('Loop Over Items6').item.json.height }}",
        "positionX": "={{ $('Loop Over Items6').item.json.x }}",
        "positionY": "={{ $('Loop Over Items6').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2288,
        4512
      ],
      "id": "ede5df33-26b5-4bf2-a623-3761d31a3e1c",
      "name": "Edit Image19"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        4320
      ],
      "id": "0a66ce8c-1480-4f53-99bf-64489765f3ec",
      "name": "Edit Fields6"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1488,
        4272
      ],
      "id": "dcf0cad7-4e54-4178-ba23-10e75f4f64bf",
      "name": "Sticky Note19"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1792,
        4432
      ],
      "id": "7318d1bb-3c60-4b2b-a361-004ea27800db",
      "name": "Code in JavaScript19"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2128,
        4512
      ],
      "id": "1faed9cc-b395-4066-8c5e-f8e1c8fc7b79",
      "name": "Edit Image20"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        1968,
        4512
      ],
      "id": "0bd70b96-1b2a-418e-abcf-dc634bbc51c2",
      "name": "Convert Base64 To File9"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (JavaScript)\n\n// 각 item에서 필요한 key만 추출\nconst cleaned = items.map(item => {\n  const s = item.json;\n  return {\n    section_name: s.section_name,\n    x: s.x,\n    y: s.y,\n    width: s.width,\n    height: s.height\n  };\n});\n\n// 하나의 item으로 묶어서 반환\nreturn [\n  {\n    json: {\n      sections: cleaned\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2832,
        3920
      ],
      "id": "9fb68fb8-c0eb-486a-8ee2-23d2c2e1422f",
      "name": "Code in JavaScript20"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3040,
        3920
      ],
      "id": "1a98d751-4179-4386-bdca-b14fe8453a0d",
      "name": "Code in JavaScript21"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        3376,
        3920
      ],
      "id": "30bcfe57-12ef-4939-bc7d-cc240e494010",
      "name": "Edit Image21"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3216,
        3920
      ],
      "id": "e99c5d9a-6205-48ca-b32f-97ce696128bd",
      "name": "Convert Base64 To File10"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "=당신은 쇼핑몰 상세이미지 분석 전문가입니다.  \n아래 제공된 좌표 데이터는 2차 재검증 결과이며,  \n당신의 임무는 이 좌표들이 실제 이미지와 완전히 일치하는지 **최종 3차 정밀 검증**을 수행하는 것입니다.\n\n- 2차 분석 좌표(JSON):  \n{{ $('Analyze image5').all()[0].json.content[0].text }}\n\n=====================================================================\n📌 **최종 검증 목적 (3차 분석의 역할)**  \n당신은 최종 단계로서,  \n**남은 오차 1px까지 잡아내고 모든 영역을 완전히 확정**해야 합니다.\n\n⚠️ 2차 분석 좌표는 참고용일 뿐, 절대 신뢰하지 않습니다.  \n⚠️ 오직 원본 이미지를 기준으로 다시 판단해야 합니다.  \n⚠️ 3차 분석에서는 “좌표 자동 보정 최적화”가 최우선입니다.\n\n=====================================================================\n📌 **3차 최종 절대 규칙 (모두 필수)**\n\n1. **1px 단위 정밀 검사**  \n   - 텍스트 또는 사진이 1px이라도 잘렸는지 재확인하고 즉시 보정할 것.\n\n2. **경계선 여유치 재확보**  \n   - 2차 분석이 너무 딱 맞게 잘린 경우,\n     위/아래/좌/우 방향으로 여유를 다시 확보해 완전 안전하게 포함.\n\n3. **영역 간 중복 금지 / 누락 금지**  \n   - 각 영역은 서로 절대로 겹치면 안 되며,\n     필요 요소가 빠져 있어도 안 됨.\n\n4. **타이틀 검증 강화**  \n   - 타이틀(예: Color View, Detail, Size Information 등)의  \n     상단과 하단 모두 포함 여부를 다시 검증.\n\n5. **영역 종료 규칙 필수 적용**  \n   - 하위 영역의 타이틀이 시작되는 순간 이전 섹션은 즉시 종료해야 함.\n\n6. **원본 이미지 기반 재판단**  \n   - 입력된 좌표가 아무리 타당해 보여도  \n     원본 이미지가 다르면 반드시 수정.\n\n=====================================================================\n📌 **영역별 3차 최종 검증 체크리스트**\n\n### 🔵 1. brand_description_section\n- 브랜드 로고/브랜드명/제품명/가격/컬러 옵션이 정확하게 포함?  \n- 컬러 옵션의 마지막 요소까지 완전 포함되었는가?  \n- 아래 첫 제품 단독 사진이 1px도 포함되지 않았는가?  \n- 상단·하단 경계가 너무 빡빡하게 잡혀 있지 않은가?\n\n### 🟣 2. product_image_section\n- 제품 단독컷(밝은 배경)만 포함되었는가?  \n- 텍스트 1px도 포함되면 즉시 수정  \n- 여러 장이면 하나의 묶음으로 정확하게 감싸고 있는가?  \n- 사진 잘림이 없는가?  \n- 상단과 하단 끝이 단독컷 경계에 정확히 맞는가?\n\n### 🟠 3. detail_cut_section\n- 확대 디테일 이미지만 포함되어 있는가?  \n- Detail/Point Detail 등의 타이틀이 있다면 완전히 포함했는가?  \n- 정보 텍스트(사이즈/소재/공지)가 포함되면 안 됨  \n- 디테일 사진이 잘리거나 누락되지 않았는가?\n\n### 🟢 4. info_section\n- 시작 지점이 “첫 정보 타이틀 상단”이 맞는가?  \n- Fabric / Size / Product Information / Notice 등 모든 정보 텍스트가 완전 포함?  \n- 디테일 이미지가 섹션 안에 들어가 있지 않은가?  \n- 페이지 최하단까지 포함했는가?\n\n=====================================================================\n📌 **출력 조건 (반드시 준수)**\n- 어떤 설명, 분석, 텍스트도 출력 금지 → **JSON only**\n- x,y,width,height 모두 정수\n- null 가능\n- 2차 분석 좌표를 그대로 복사 금지  \n  → 반드시 원본 이미지 기준으로 다시 계산한 결과만 출력\n\n=====================================================================\n📤 **최종 출력 형식 (반드시 동일)**\n```json\n{\n  \"original_image_size\": {\n    \"width\": number,\n    \"height\": number\n  },\n  \"sections\": {\n    \"brand_description_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"product_image_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"detail_cut_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null,\n    \"info_section\": {\n      \"x\": number,\n      \"y\": number,\n      \"width\": number,\n      \"height\": number\n    } | null\n  }\n}\n",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        3552,
        3920
      ],
      "id": "0a7c9959-9bb3-43d6-927a-2fe4f8664bce",
      "name": "Analyze image6",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) INPUT TEXT 가져오기\n// -----------------------------------------\nconst items = $input.all();\nconst rawText = items[0].json.content[0].text;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) AI가 준 JSON Codeblock 추출\n// -----------------------------------------\nfunction extractJsonBlock(text) {\n  const match = text.match(/```json([\\s\\S]*?)```/);\n  if (!match) return null;\n\n  try {\n    return JSON.parse(match[1].trim());\n  } catch (e) {\n    throw new Error(\"JSON 파싱 실패: \" + e.message);\n  }\n}\n\nconst parsed = extractJsonBlock(rawText);\nif (!parsed) throw new Error(\"JSON 코드 블록을 찾을 수 없습니다.\");\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 적용 함수 (null-safe)\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections는 object → array 로 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 자동 제외하고 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3808,
        3920
      ],
      "id": "bec9bf12-7d6a-4d49-b711-2a56e5d8722c",
      "name": "Code in JavaScript22"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        4160,
        4144
      ],
      "id": "26802b09-3f2a-4c0e-acd6-e249697cd9e6",
      "name": "Loop Over Items7"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items7').item.json.width }}",
        "height": "={{ $('Loop Over Items7').item.json.height }}",
        "positionX": "={{ $('Loop Over Items7').item.json.x }}",
        "positionY": "={{ $('Loop Over Items7').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        4864,
        4320
      ],
      "id": "d1c8faa6-3178-4211-9f69-50b59565ba91",
      "name": "Edit Image22"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1e6fa0bf-3826-444d-9835-dbd5b4563abb",
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4576,
        4128
      ],
      "id": "75bee83a-41d0-454a-ad02-2afc3352e0ca",
      "name": "Edit Fields7"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4032,
        4080
      ],
      "id": "d6d9e15e-bb7c-47d3-aeff-04bc23bce4dd",
      "name": "Sticky Note20"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4368,
        4240
      ],
      "id": "26da00a5-dae6-4fb1-9468-2c4476f5df38",
      "name": "Code in JavaScript23"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        4704,
        4320
      ],
      "id": "b7bd6ae7-fb8d-406f-8c1d-35389f8b7d57",
      "name": "Edit Image23"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        4544,
        4320
      ],
      "id": "de2105b5-a91c-49e8-b86f-9f56369f30f2",
      "name": "Convert Base64 To File11"
    },
    {
      "parameters": {
        "content": "## 이미지 URL 하나로 이미지 File로 합치기",
        "height": 416,
        "width": 1200,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -384,
        5168
      ],
      "id": "f053498f-30f0-4f43-b823-1db319dde68d",
      "name": "Sticky Note21"
    },
    {
      "parameters": {
        "content": "## 이미지 URL입력",
        "height": 208,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -656,
        5168
      ],
      "id": "5cd58c6c-5d8c-4108-8d46-6f99d4e436e6",
      "name": "Sticky Note22"
    },
    {
      "parameters": {
        "formTitle": "ImageURL",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ImageURL_1",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DgEkKV6sXnOiqFUn%252Bp945NydZ%252BMxo5%252B%252BCcenV4eHhnJ3x4wntcBJj2NtMBK6T5sgSbkEkEjyfnVXErgfDWC%252BxE9TgP5rQXpfDSdbR7siz5o%252FUfqbUg%252FgPQElA0ppuH74kH8radbl4tSV6bkZGhHOPc%252BMyKpMhunPMXehnLaOpJms%252BwEgGDov2S%252BXFdBhrVVeDssv2%252FZZOkO3moZth5LA6CMqVNTDMt3mvU1SAv9SJj6cL0WvuC9A1tOZZs1nWy2PKjyGfyTtv7yrxtMsc12IcnTp5uGTUwbJcsBa3prCgCEYH0%252FMzaKtt%252ByhqucoKHqQ98VefeBYgYvvuQPxLljUI%252FA%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_2",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DJkar0mBDdrc0q0URN2utCKTAfExoP0cnHL1IVLf5qbD2lTnszQqFUX1iZVi9s7tHUpFJmvzQM5lyQ8ZByTlrNl21xZNwaw%252BFe6vMniniF%252BEVjtYa%252B9mRPdwLMQ4nfHN5LN1kBAPoBqNtlgs4ffx41fdrLzfr%252Br9xrjaSix4zkxq5DDM5HF2QFWs4Qjpx%252BO5n2Z%252FjSExxl%252F65WsqL9cHet7TfPLDml8Zzox%252Bj19H7CCGYDxmHJGK5zXteoYDXHolWjSFMD9bgllMZZwOIX9jevxxFLeq9F1Or15aVUQxUATgkQOjdS2wEk1CUzlG5EGWhZmIZvXZ3doH5cH27IGoOkw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_3",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DiVrSM2199i%252FvfHEe%252BsnyThfr76rvg5rau3AE7tiBI7lvjvbsuz1RqQNcpbLOsbS%252B1845%252BcJXJ9woaQ3K%252B8m5xQIT3IZ%252FnjGash6ABr%252BvwdfKR3HxNsmEewXgjR5yMnNKz6i2Q7cqwsZ7wiwo%252Fc%252Fbw94iwekU%252ByU%252FELFcazB6Cegc53nsCgnYdO2Y9rXquunZKuVGwSA3FJAoPf6pnbFW1eUpFiKwid8QBGXo70qAReVTGsjKzVlvD%252BMCa93Rf%252BTmb%252FmqhsZO3nDYPCVFpC2QQFm0m%252BZdUVwYAYU4GZHPqWaT09jft03eCOWe4xm2A2%252BGYBCdv4kgBulJaXt3i%252Bwhbw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_4",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DbnqpSSsxIXGE5UI1nxtb8KMeZZQdRd7UEMy2WW60cHUGFRy9kry0UImshKeacoNkmXveQK0LyE7CXswjuNbvv6sbCLaAq9tJxm8SCb4ivUO5KIYDiACrrKYxsnIkJOOI1WJ3mQIgEBd569ZuWtCRcIRCW1NUCTewbQs5grwKdPL5KHGfrWouqYD3cjJ0RUeNrx461uh9M6b3lx5JQCWJghudxd3WN%252Fpaa%252F7EaXO5NnOTdNRoQj6PN%252Bvuc%252Fc4stJ5qZEQ6jhNFnZR2JF4PTPYyJkG%252Flz5EnkLeouBNlKdrifCq4xBkqjwV%252F5y%252FO983RRrOZqK0VsAmKIbP78vlIKGQg%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_5",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQaP4z9XdQJb9YguLzHLbVbwHaPqZTNTxZyt78ZFIUpbvujJ%252BTs5h%252FelsvABXLkm%252F%252B8FkB1dfr9qxd00pJ8LXkW4VQkemzQT9ftZq9Iw3u5xnXN9tRWaK%252FOMYJz6%252FYYqsRftCMxsIx4sZk1F18PIwewwHjuM9c1kaRINJp0nLY6NystjCNCMyWFnI9yzOXp9pWKd6V7YBrcaSXrY6flbKw1djzsvow3sP5I%252B77DtQzG9t3AOhnbISUNp7wUmhnZWQrdxdealDRyh1609ovpIYCF9jegaE395IxUJUvpCY46J5TxrnBtDtkA1KY2f5hjmQxVAMCdpDLn%252FtA1KAyXkZow%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "Json Code",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -560,
        5248
      ],
      "id": "dcc051b1-9d9c-4e29-a4ce-51c7f3e72283",
      "name": "Input ImageURL2",
      "webhookId": "53532448-5ad5-4b00-b2a7-bba4c4c195a2"
    },
    {
      "parameters": {
        "jsCode": "// 입력 데이터 받기\nconst item = $input.all()[0].json;\n\n// URL 패턴이 \"ImageURL_숫자\" 형태인 항목만 추출\nconst urls = Object.keys(item)\n  .filter(key => key.startsWith(\"ImageURL_\"))\n  .map(key => ({\n    index: parseInt(key.replace(\"ImageURL_\", \"\")), // 번호 추출\n    key,\n    url: item[key]\n  }))\n  .sort((a, b) => a.index - b.index); // 번호 순 정렬\n\n// 각 URL을 개별 아이템으로 반환\nreturn urls.map(obj => ({\n  json: obj\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -352,
        5248
      ],
      "id": "ee82685d-3aa1-4731-893e-b1fecb902887",
      "name": "Make URL Array2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -144,
        5248
      ],
      "id": "ca358b31-690c-4436-956e-12db36e62c8b",
      "name": "Loop Over URLs2"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "={{ $json.key }}"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        144,
        5392
      ],
      "id": "c97843d7-5cb2-4e0d-b0dd-741a5b0c3b46",
      "name": "ImageURL To File2"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "={{ $json.key }}",
        "destinationKey": "={{ $json.key }}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        336,
        5392
      ],
      "id": "1cf756d0-4337-4941-a127-c6c71f4f904b",
      "name": "File To Base1"
    },
    {
      "parameters": {
        "jsCode": "let merged = {};\n\nfor (const item of items) {\n  Object.assign(merged, item.json);\n}\n\nreturn [\n  {\n    json: merged\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        192,
        5232
      ],
      "id": "80ece79b-4064-491f-b6f3-151c544d6b9d",
      "name": "Make Base64 Array2"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "import base64\nfrom PIL import Image\nfrom io import BytesIO\n\nimages_b64 = [\n  _input.first().json.ImageURL_1,\n  _input.first().json.ImageURL_2,\n  _input.first().json.ImageURL_3,\n  _input.first().json.ImageURL_4,\n  _input.first().json.ImageURL_5,\n]\n\n# base64 → PIL Image\nimages = []\nfor b64 in images_b64:\n    if b64:\n        data = base64.b64decode(b64.split(',')[-1])\n        images.append(Image.open(BytesIO(data)))\n\n# 크기 계산\nmax_width = max(img.width for img in images)\ntotal_height = sum(img.height for img in images)\n\n# 합치기\ncombined = Image.new('RGB', (max_width, total_height), 'white')\ny_offset = 0\nfor img in images:\n    combined.paste(img, (0, y_offset))\n    y_offset += img.height\n\n# 원본 사이즈 읽기 (재변환 필요 없음!)\norig_w, orig_h = combined.size\n\n# target 높이\ntarget_h = 8000\n\n# 비율에 맞는 width 계산\ntarget_w = int(orig_w * (target_h / orig_h))\n\n# base64로 반환\nbuffer = BytesIO()\ncombined.save(buffer, format='JPEG', quality=90)\nresult_b64 = base64.b64encode(buffer.getvalue()).decode()\n\nreturn {\n    \"resize_width\": target_w,\n    \"resize_height\": target_h,\n    \"combinedImage\": result_b64\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        448,
        5232
      ],
      "id": "214a32ca-1c96-4133-ae43-ff78c59aa215",
      "name": "Attach Base1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1552,
        5232
      ],
      "id": "c7f66e3f-2a11-47a0-9053-fbf15a220551",
      "name": "Loop Over Items8"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Loop Over Items8').item.json.width }}",
        "height": "={{ $('Loop Over Items8').item.json.height }}",
        "positionX": "={{ $('Loop Over Items8').item.json.x }}",
        "positionY": "={{ $('Loop Over Items8').item.json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2256,
        5408
      ],
      "id": "48339c38-7da6-4953-b799-ee77ec35dcee",
      "name": "Edit Image24"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1e6fa0bf-3826-444d-9835-dbd5b4563abb",
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1968,
        5216
      ],
      "id": "888eb48b-29b0-49b0-80a5-11ff5126b6de",
      "name": "Edit Fields8"
    },
    {
      "parameters": {
        "content": "## 이미지 나누기",
        "height": 464,
        "width": 1040,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1424,
        5168
      ],
      "id": "7dbf4d55-80c0-4008-a3a3-99e4ab98bbca",
      "name": "Sticky Note24"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base1').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1760,
        5328
      ],
      "id": "d88c9f00-5ade-416c-972f-869b280641c2",
      "name": "Code in JavaScript24"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base1').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base1').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        2096,
        5408
      ],
      "id": "95ab71a9-72ea-4d09-bdb6-a09d1ab8cd17",
      "name": "Edit Image25"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        1936,
        5408
      ],
      "id": "edddb559-5a22-42f7-8fe5-4589768cc462",
      "name": "Convert Base64 To File13"
    },
    {
      "parameters": {
        "jsCode": "// -----------------------------------------\n// 1) 수기로 JSON 입력\n// -----------------------------------------\nconst rawText = `\n{\n  \"original_image_size\": { \"width\": 800, \"height\": 9500 },\n  \"sections\": {\n    \"brand_description_section\": { \"x\": 0, \"y\": 0, \"width\": 800, \"height\": 1800 },\n    \"product_image_section\": { \"x\": 0, \"y\": 1800, \"width\": 800, \"height\": 5000 },\n    \"detail_cut_section\": { \"x\": 0, \"y\": 6800, \"width\": 800, \"height\": 1000 },\n    \"info_section\": { \"x\": 0, \"y\": 7800, \"width\": 800, \"height\": 1700 }\n  }\n}\n`;\n\n// 원본 이미지 리사이즈 후 실제 height\nconst originalHeight = 8000;\n\n// -----------------------------------------\n// 2) JSON 파싱\n// -----------------------------------------\nlet parsed;\ntry {\n  parsed = JSON.parse(rawText.trim());\n} catch (e) {\n  throw new Error(\"직접 입력한 JSON 파싱 실패: \" + e.message);\n}\n\n// AI가 본 이미지 정보\nconst aiImageWidth = parsed.original_image_size.width;\nconst aiImageHeight = parsed.original_image_size.height;\n\n// 스케일 계산\nconst scale = originalHeight / aiImageHeight;\n\n// -----------------------------------------\n// 3) 스케일 변환 함수\n// -----------------------------------------\nfunction scaleBox(name, section) {\n  if (!section || section.x == null || section.y == null) {\n    return {\n      section_name: name,\n      skipped: true,\n      reason: \"section is null or missing coordinates\"\n    };\n  }\n\n  return {\n    section_name: name,\n    x: Math.round(section.x * scale),\n    y: Math.round(section.y * scale),\n    width: Math.round(section.width * scale),\n    height: Math.round(section.height * scale),\n    ai_height: aiImageHeight,\n    original_height: originalHeight,\n    scale_factor: scale\n  };\n}\n\n// -----------------------------------------\n// 4) sections object → array 변환\n// -----------------------------------------\nconst sectionEntries = Object.entries(parsed.sections);\n\n// -----------------------------------------\n// 5) null / 좌표 없는 section 제외 후 출력\n// -----------------------------------------\nconst outputs = sectionEntries\n  .filter(([name, data]) => data && data.x !== undefined && data.y !== undefined)\n  .map(([name, data]) => ({\n    json: scaleBox(name, data)\n  }));\n\nreturn outputs;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        992,
        5232
      ],
      "id": "50137a56-75e8-4dfa-8491-88cc00e1e212",
      "name": "Code in JavaScript25"
    },
    {
      "parameters": {
        "formTitle": "ImageEditor",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Main_Image",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        2704,
        304
      ],
      "id": "6b9468bc-cc17-41fb-826a-017a625ca780",
      "name": "Image Editor5",
      "webhookId": "82691481-a742-4e6d-b718-7cf385f5833c"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "Main_Image",
        "destinationKey": "Main_Image",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        3088,
        304
      ],
      "id": "29820c90-01c7-4ea3-b4dd-592d2f1d45f2",
      "name": "MainImage Convert_10"
    },
    {
      "parameters": {
        "url": "={{ $json.Main_Image }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Main_Image"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2896,
        304
      ],
      "id": "be41d3eb-e3f2-4838-abd1-306aeb021513",
      "name": "MainImage Convert_14"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent\n",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\" : [{\n    \"parts\": [\n      {\n          \"text\": {{ $json.cleanedPrompt }}\n        },\n      {\n        \"inline_data\": {\n          \"mime_type\": \"image/jpeg\",\n          \"data\": \"{{ $('MainImage Convert_10').item.json.Main_Image }}\"\n        }\n      }\n    ]\n  }],\n  \"generationConfig\": {\n    \"responseModalities\": [\"TEXT\", \"IMAGE\"],\n    \"imageConfig\": {\n      \"aspectRatio\": \"4:5\",\n      \"imageSize\": \"1K\"\n    }\n  } \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3696,
        304
      ],
      "id": "16930f7f-31cc-4b16-94a0-8f49d260cadf",
      "name": "HTTP Request7",
      "credentials": {
        "httpHeaderAuth": {
          "id": "byaaZUic5fl64TPn",
          "name": "Nano Banana"
        }
      }
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "candidates[0].content.parts[0].inlineData.data",
        "binaryPropertyName": "MainImage",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3872,
        304
      ],
      "id": "e60b01ba-7fed-4f38-96dd-98a8a922a3f1",
      "name": "Convert to File9"
    },
    {
      "parameters": {
        "content": "## 누끼샷 만들기",
        "height": 256,
        "width": 1520,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2640,
        224
      ],
      "id": "7bd3d6db-4bf7-4ceb-831d-88694b53a735",
      "name": "Sticky Note23"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "시트1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Prompt Name",
              "lookupValue": "background-removed image"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3296,
        304
      ],
      "id": "83691646-583a-45bb-8d11-dbcef5c3fa43",
      "name": "Get row(s) in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Isn2z9duv7UXzATf",
          "name": "Google Sheets Juunnmmoo"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n  item.json.cleanedPrompt = JSON.stringify(item.json.Prompt);\n}\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3504,
        304
      ],
      "id": "db782e12-1795-4c49-afa2-ff911840a388",
      "name": "Code in JavaScript26"
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-pro-latest",
          "mode": "list",
          "cachedResultName": "models/gemini-pro-latest"
        },
        "text": "={{ $('Code in JavaScript27').all()[0].json.cleanedPrompt }}",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        5488,
        800
      ],
      "id": "d561e7f5-9cc5-468c-8012-59e1674f67b6",
      "name": "Analyze an image",
      "credentials": {
        "googlePalmApi": {
          "id": "vhb8mOyWWRrLq5Ra",
          "name": "NanoBanana-Test"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit?usp=sharing",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "시트1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Erd4uxOncPeg2KOFB-Tbtoo1rt1A0fzEDPTtJUnYZSQ/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Prompt Name",
              "lookupValue": "info_section"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4752,
        560
      ],
      "id": "73deb24b-b48e-4be6-87f4-d9cfe5b2f6b4",
      "name": "Get row(s) in sheet3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Isn2z9duv7UXzATf",
          "name": "Google Sheets Juunnmmoo"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n  item.json.cleanedPrompt = JSON.stringify(item.json.Prompt);\n}\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4944,
        560
      ],
      "id": "66c750d2-2973-413b-ba96-60d7ea843355",
      "name": "Code in JavaScript27"
    },
    {
      "parameters": {
        "content": "## 이미지 URL 하나로 이미지 File로 합치기",
        "height": 464,
        "width": 1120,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        3904,
        720
      ],
      "id": "11710786-f50c-4ff7-a4c5-29390f426600",
      "name": "Sticky Note25"
    },
    {
      "parameters": {
        "content": "## 이미지 URL입력",
        "height": 208,
        "width": 400,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        3488,
        736
      ],
      "id": "1e11e91a-c4b4-4fa1-a6fd-107c0cb700b9",
      "name": "Sticky Note26"
    },
    {
      "parameters": {
        "formTitle": "ImageURL",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ImageURL_1",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DgEkKV6sXnOiqFUn%252Bp945NydZ%252BMxo5%252B%252BCcenV4eHhnJ3x4wntcBJj2NtMBK6T5sgSbkEkEjyfnVXErgfDWC%252BxE9TgP5rQXpfDSdbR7siz5o%252FUfqbUg%252FgPQElA0ppuH74kH8radbl4tSV6bkZGhHOPc%252BMyKpMhunPMXehnLaOpJms%252BwEgGDov2S%252BXFdBhrVVeDssv2%252FZZOkO3moZth5LA6CMqVNTDMt3mvU1SAv9SJj6cL0WvuC9A1tOZZs1nWy2PKjyGfyTtv7yrxtMsc12IcnTp5uGTUwbJcsBa3prCgCEYH0%252FMzaKtt%252ByhqucoKHqQ98VefeBYgYvvuQPxLljUI%252FA%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_2",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DJkar0mBDdrc0q0URN2utCKTAfExoP0cnHL1IVLf5qbD2lTnszQqFUX1iZVi9s7tHUpFJmvzQM5lyQ8ZByTlrNl21xZNwaw%252BFe6vMniniF%252BEVjtYa%252B9mRPdwLMQ4nfHN5LN1kBAPoBqNtlgs4ffx41fdrLzfr%252Br9xrjaSix4zkxq5DDM5HF2QFWs4Qjpx%252BO5n2Z%252FjSExxl%252F65WsqL9cHet7TfPLDml8Zzox%252Bj19H7CCGYDxmHJGK5zXteoYDXHolWjSFMD9bgllMZZwOIX9jevxxFLeq9F1Or15aVUQxUATgkQOjdS2wEk1CUzlG5EGWhZmIZvXZ3doH5cH27IGoOkw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_3",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DiVrSM2199i%252FvfHEe%252BsnyThfr76rvg5rau3AE7tiBI7lvjvbsuz1RqQNcpbLOsbS%252B1845%252BcJXJ9woaQ3K%252B8m5xQIT3IZ%252FnjGash6ABr%252BvwdfKR3HxNsmEewXgjR5yMnNKz6i2Q7cqwsZ7wiwo%252Fc%252Fbw94iwekU%252ByU%252FELFcazB6Cegc53nsCgnYdO2Y9rXquunZKuVGwSA3FJAoPf6pnbFW1eUpFiKwid8QBGXo70qAReVTGsjKzVlvD%252BMCa93Rf%252BTmb%252FmqhsZO3nDYPCVFpC2QQFm0m%252BZdUVwYAYU4GZHPqWaT09jft03eCOWe4xm2A2%252BGYBCdv4kgBulJaXt3i%252Bwhbw%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_4",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DbnqpSSsxIXGE5UI1nxtb8KMeZZQdRd7UEMy2WW60cHUGFRy9kry0UImshKeacoNkmXveQK0LyE7CXswjuNbvv6sbCLaAq9tJxm8SCb4ivUO5KIYDiACrrKYxsnIkJOOI1WJ3mQIgEBd569ZuWtCRcIRCW1NUCTewbQs5grwKdPL5KHGfrWouqYD3cjJ0RUeNrx461uh9M6b3lx5JQCWJghudxd3WN%252Fpaa%252F7EaXO5NnOTdNRoQj6PN%252Bvuc%252Fc4stJ5qZEQ6jhNFnZR2JF4PTPYyJkG%252Flz5EnkLeouBNlKdrifCq4xBkqjwV%252F5y%252FO983RRrOZqK0VsAmKIbP78vlIKGQg%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            },
            {
              "fieldLabel": "ImageURL_5",
              "placeholder": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcZXy1MyUnL0B9CK1SHGqT%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQaP4z9XdQJb9YguLzHLbVbwHaPqZTNTxZyt78ZFIUpbvujJ%252BTs5h%252FelsvABXLkm%252F%252B8FkB1dfr9qxd00pJ8LXkW4VQkemzQT9ftZq9Iw3u5xnXN9tRWaK%252FOMYJz6%252FYYqsRftCMxsIx4sZk1F18PIwewwHjuM9c1kaRINJp0nLY6NystjCNCMyWFnI9yzOXp9pWKd6V7YBrcaSXrY6flbKw1djzsvow3sP5I%252B77DtQzG9t3AOhnbISUNp7wUmhnZWQrdxdealDRyh1609ovpIYCF9jegaE395IxUJUvpCY46J5TxrnBtDtkA1KY2f5hjmQxVAMCdpDLn%252FtA1KAyXkZow%253D%253D&width=800&format=webp&quality=100",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        3552,
        800
      ],
      "id": "dde4944e-14ed-411a-83c9-262dec0a9cf4",
      "name": "Input ImageURL3",
      "webhookId": "e8828be5-083d-40eb-9f78-699cbe49d70a"
    },
    {
      "parameters": {
        "jsCode": "// 입력 데이터 받기\nconst item = $input.all()[0].json;\n\n// URL 패턴이 \"ImageURL_숫자\" 형태인 항목만 추출\nconst urls = Object.keys(item)\n  .filter(key => key.startsWith(\"ImageURL_\"))\n  .map(key => ({\n    index: parseInt(key.replace(\"ImageURL_\", \"\")), // 번호 추출\n    key,\n    url: item[key]\n  }))\n  .sort((a, b) => a.index - b.index); // 번호 순 정렬\n\n// 각 URL을 개별 아이템으로 반환\nreturn urls.map(obj => ({\n  json: obj\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3744,
        800
      ],
      "id": "e0b620c0-b3ab-43d2-98ad-b281c4639994",
      "name": "Make URL Array3"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        4000,
        800
      ],
      "id": "f033f2d1-1c75-4457-afc8-07b2c02047bd",
      "name": "Loop Over URLs3"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "={{ $json.key }}"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        4288,
        944
      ],
      "id": "e139c4ef-7053-46a9-a94e-6e0464cb932e",
      "name": "ImageURL To File3"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "binaryPropertyName": "={{ $json.key }}",
        "destinationKey": "={{ $json.key }}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        4480,
        944
      ],
      "id": "846d9a1d-61e0-4acb-9113-d4d77a2cd9f9",
      "name": "File To Base65"
    },
    {
      "parameters": {
        "jsCode": "let merged = {};\n\nfor (const item of items) {\n  Object.assign(merged, item.json);\n}\n\nreturn [\n  {\n    json: merged\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4336,
        784
      ],
      "id": "9531e874-a03d-4739-9cb8-0ccb906210e8",
      "name": "Make Base64 Array3"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "import base64\nfrom PIL import Image\nfrom io import BytesIO\n\nimages_b64 = [\n  _input.first().json.ImageURL_1,\n  _input.first().json.ImageURL_2,\n  _input.first().json.ImageURL_3,\n  _input.first().json.ImageURL_4,\n  _input.first().json.ImageURL_5,\n]\n\n# base64 → PIL Image\nimages = []\nfor b64 in images_b64:\n    if b64:\n        data = base64.b64decode(b64.split(',')[-1])\n        images.append(Image.open(BytesIO(data)))\n\n# 크기 계산\nmax_width = max(img.width for img in images)\ntotal_height = sum(img.height for img in images)\n\n# 합치기\ncombined = Image.new('RGB', (max_width, total_height), 'white')\ny_offset = 0\nfor img in images:\n    combined.paste(img, (0, y_offset))\n    y_offset += img.height\n\n# 원본 사이즈 읽기 (재변환 필요 없음!)\norig_w, orig_h = combined.size\n\n# target 높이\ntarget_h = 8000\n\n# 비율에 맞는 width 계산\ntarget_w = int(orig_w * (target_h / orig_h))\n\n# base64로 반환\nbuffer = BytesIO()\ncombined.save(buffer, format='JPEG', quality=90)\nresult_b64 = base64.b64encode(buffer.getvalue()).decode()\n\nreturn {\n    \"resize_width\": target_w,\n    \"resize_height\": target_h,\n    \"combinedImage\": result_b64\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4592,
        784
      ],
      "id": "fa0e3c67-139c-43d0-84ab-59613f749ab6",
      "name": "Attach Base65"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        5072,
        800
      ],
      "id": "3f585a37-572c-4e8c-8e81-39f066fbc401",
      "name": "Convert Base64 To File12"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base65').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4880,
        800
      ],
      "id": "b83a0bc2-ff6e-4469-a5d3-f410895d3891",
      "name": "Code in JavaScript28"
    },
    {
      "parameters": {
        "jsCode": "// =======================================================\n// 1) AI output (TEXT 형태) 가져오기\n// =======================================================\nlet text = $json.content?.parts?.[0]?.text || $json.text || \"\";\n\nif (!text) {\n  throw new Error(\"AI로부터 받은 텍스트를 찾을 수 없습니다.\");\n}\n\n// =======================================================\n// 2) ```json ... ``` 안의 JSON만 추출\n// =======================================================\nconst jsonMatch = text.match(/```json([\\s\\S]*?)```/);\n\nif (!jsonMatch) {\n  throw new Error(\"텍스트 안에서 JSON 블록을 찾을 수 없습니다.\");\n}\n\nlet jsonString = jsonMatch[1].trim();\n\n// =======================================================\n// 3) JSON 문자열을 실제 객체로 변환\n// =======================================================\nlet item;\ntry {\n  item = JSON.parse(jsonString);\n} catch (e) {\n  throw new Error(\"JSON 파싱 실패: \" + e.message);\n}\n\n// =======================================================\n// 4) 원본 이미지 크기 (Attach Base65)에서 가져오기\n// =======================================================\nconst base = $('Attach Base65').first().json;\n\nconst W_org = base.resize_width;\nconst H_org = base.resize_height;\n\nif (!W_org || !H_org) {\n  throw new Error(\"원본 이미지 크기(resize_width, resize_height)를 찾을 수 없습니다.\");\n}\n\n// =======================================================\n// 5) AI가 본 이미지 크기(ai_processed_size)\n// =======================================================\nconst ai = item.ai_processed_size;\n\nif (!ai || !ai.width || !ai.height) {\n  throw new Error(\"ai_processed_size.width/height가 존재하지 않습니다.\");\n}\n\nconst W_ai = ai.width;\nconst H_ai = ai.height;\n\n// =======================================================\n// 6) 스케일링 함수\n// =======================================================\nfunction scale(value, original, ai) {\n  return Math.round(value * (original / ai));\n}\n\n// =======================================================\n// 7) 섹션 좌표를 원본 스케일 기준으로 변환\n// =======================================================\nconst output = [];\n\nfor (const key in item.sections) {\n  const sec = item.sections[key];\n\n  const scaled = {\n    section_name: key,\n    x: scale(sec.x, W_org, W_ai),\n    y: scale(sec.y, H_org, H_ai),\n    width: scale(sec.width, W_org, W_ai),\n    height: scale(sec.height, H_org, H_ai)\n  };\n\n  output.push({ json: scaled });\n}\n\n// =======================================================\n// 8) n8n의 Code node는 배열을 반환해야 함\n// =======================================================\nreturn output;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5792,
        800
      ],
      "id": "bcf3177c-9e80-4604-9964-a52a519a75a5",
      "name": "Code in JavaScript29"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Code in JavaScript29').all()[0].json.width }}",
        "height": "={{ $('Code in JavaScript29').all()[0].json.height }}",
        "positionX": "=0",
        "positionY": "={{ $('Code in JavaScript29').all()[0].json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        6672,
        800
      ],
      "id": "b3fb2a1f-2c04-4338-9dd3-1e8e545a219c",
      "name": "Edit Image26"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        5872,
        560
      ],
      "id": "ee421d27-fa61-4784-9db9-86383c773555",
      "name": "Edit Fields9"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        6256,
        800
      ],
      "id": "fe73e552-cba4-4cb5-be37-7f040d189fa2",
      "name": "Convert Base64 To File14"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base65').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6080,
        800
      ],
      "id": "94cdbe7f-9be5-4171-838e-0928d82c699f",
      "name": "Code in JavaScript30"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base65').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base65').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        6464,
        800
      ],
      "id": "2ca1b8a9-e24c-4dba-8117-397d2365cbc4",
      "name": "Resize Image2"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base65').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base65').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        5280,
        800
      ],
      "id": "af9626b2-e801-42a7-a17a-eea0e0bf2e10",
      "name": "Edit Image1"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101"
        },
        "text": "={{ $('Code in JavaScript27').all()[0].json.cleanedPrompt }}",
        "inputType": "binary",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        5488,
        976
      ],
      "id": "76d69e5b-5df2-419d-8df1-72ad6e5bed42",
      "name": "Analyze image7",
      "credentials": {
        "anthropicApi": {
          "id": "s53gMH1GWKtYEmUN",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// =======================================================\n// 1) AI output (TEXT 형태) 가져오기\n// =======================================================\nlet text = \"\";\n\n// 형태 1: { content: [ { type: \"text\", text: \"...\" } ] }\nif ($json.content && Array.isArray($json.content) && $json.content[0]?.text) {\n  text = $json.content[0].text;\n}\n\n// 형태 2: { content: [ { parts: [ { text: \"...\" } ] } ] }\nif (!text && $json.content?.[0]?.parts?.[0]?.text) {\n  text = $json.content[0].parts[0].text;\n}\n\n// 형태 3: 일반 text\nif (!text && $json.text) {\n  text = $json.text;\n}\n\nif (!text) {\n  throw new Error(\"AI로부터 받은 텍스트를 찾을 수 없습니다.\");\n}\n\n// =======================================================\n// 2) ```json ... ``` 안의 JSON만 추출\n// =======================================================\nconst jsonMatch = text.match(/```json([\\s\\S]*?)```/);\n\nif (!jsonMatch) {\n  throw new Error(\"텍스트 안에서 JSON 블록을 찾을 수 없습니다.\");\n}\n\nlet jsonString = jsonMatch[1].trim();\n\n// =======================================================\n// 3) JSON 문자열을 실제 객체로 변환\n// =======================================================\nlet item;\ntry {\n  item = JSON.parse(jsonString);\n} catch (e) {\n  throw new Error(\"JSON 파싱 실패: \" + e.message);\n}\n\n// =======================================================\n// 4) 원본 이미지 크기 (Attach Base65 노드)에서 가져오기\n// =======================================================\nconst base = $('Attach Base65').first().json;\n\nconst W_org = base.resize_width;\nconst H_org = base.resize_height;\n\nif (!W_org || !H_org) {\n  throw new Error(\"원본 이미지 크기(resize_width, resize_height)를 찾을 수 없습니다.\");\n}\n\n// =======================================================\n// 5) AI가 본 이미지 크기(ai_processed_size)\n// =======================================================\nconst ai = item.ai_processed_size;\n\nif (!ai || !ai.width || !ai.height) {\n  throw new Error(\"ai_processed_size.width/height가 존재하지 않습니다.\");\n}\n\nconst W_ai = ai.width;\nconst H_ai = ai.height;\n\n// =======================================================\n// 6) 스케일링 함수\n// =======================================================\nfunction scale(value, original, ai) {\n  return Math.round(value * (original / ai));\n}\n\n// =======================================================\n// 7) 섹션 좌표를 원본 스케일 기준으로 변환\n// =======================================================\nconst output = [];\n\nfor (const key in item.sections) {\n  const sec = item.sections[key];\n\n  const scaled = {\n    section_name: key,\n    x: scale(sec.x, W_org, W_ai),\n    y: scale(sec.y, H_org, H_ai),\n    width: scale(sec.width, W_org, W_ai),\n    height: scale(sec.height, H_org, H_ai)\n  };\n\n  output.push({ json: scaled });\n}\n\n// =======================================================\n// 8) n8n의 Code node는 배열을 반환해야 함\n// =======================================================\nreturn output;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5792,
        976
      ],
      "id": "76cbf789-255c-433b-a835-e455cac847ea",
      "name": "Code in JavaScript31"
    },
    {
      "parameters": {
        "operation": "crop",
        "dataPropertyName": "Image",
        "width": "={{ $('Code in JavaScript31').all()[0].json.width }}",
        "height": "={{ $('Code in JavaScript31').all()[0].json.height }}",
        "positionX": "=0",
        "positionY": "={{ $('Code in JavaScript31').all()[0].json.y }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        6704,
        976
      ],
      "id": "7225ed1e-f551-4511-9273-20b5707edd90",
      "name": "Edit Image27"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "Image",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        6288,
        976
      ],
      "id": "aaec3641-bf8c-460f-ae44-eeedacae49f0",
      "name": "Convert Base64 To File15"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      base64: $('Attach Base65').all()[0].json.combinedImage\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6080,
        976
      ],
      "id": "ef7a2678-2a37-4679-a4ec-9c54184d340c",
      "name": "Code in JavaScript32"
    },
    {
      "parameters": {
        "operation": "resize",
        "dataPropertyName": "Image",
        "width": "={{ $('Attach Base65').all()[0].json.resize_width }}",
        "height": "={{ $('Attach Base65').all()[0].json.resize_height }}",
        "options": {}
      },
      "type": "n8n-nodes-base.editImage",
      "typeVersion": 1,
      "position": [
        6496,
        976
      ],
      "id": "f14d3247-8d76-4c07-a966-264405edc893",
      "name": "Resize Image3"
    }
  ],
  "connections": {
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Image": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Convert to File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File1": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Extract from File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Multiple Images": {
      "main": [
        [
          {
            "node": "Extract from File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File2": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Editor3": {
      "main": [
        [
          {
            "node": "MainImage Convert_7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_6": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_7": {
      "main": [
        [
          {
            "node": "MainImage Convert_6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request5": {
      "main": [
        [
          {
            "node": "Convert to File7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "HTTP Request5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request6": {
      "main": [
        [
          {
            "node": "Convert to File8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "HTTP Request6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_8": {
      "main": [
        [
          {
            "node": "MainImage Convert_",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Editor4": {
      "main": [
        [
          {
            "node": "MainImage Convert_8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_9": {
      "main": [
        [
          {
            "node": "MainImage Convert_1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Editor": {
      "main": [
        [
          {
            "node": "MainImage Convert_9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_1": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "MainImage Convert_11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image4": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_11": {
      "main": [
        [
          {
            "node": "Edit Image4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_12": {
      "main": [
        [
          {
            "node": "Edit Image5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image5": {
      "main": [
        [
          {
            "node": "Analyze image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "MainImage Convert_13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image6": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_13": {
      "main": [
        [
          {
            "node": "Edit Image7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Input ImageURL": {
      "main": [
        [
          {
            "node": "Make URL Array",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make URL Array": {
      "main": [
        [
          {
            "node": "Loop Over URLs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over URLs": {
      "main": [
        [
          {
            "node": "Make Base64 Array",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ImageURL To File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ImageURL To File": {
      "main": [
        [
          {
            "node": "File To Base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File To Base64": {
      "main": [
        [
          {
            "node": "Loop Over URLs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make Base64 Array": {
      "main": [
        [
          {
            "node": "Attach Base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Attach Base64": {
      "main": [
        [
          {
            "node": "Convert Base64 To File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resize Image": {
      "main": [
        [
          {
            "node": "Analyze image1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File": {
      "main": [
        [
          {
            "node": "Resize Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Code in JavaScript6",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image8": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image1": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript5": {
      "main": [
        [
          {
            "node": "Convert Base64 To File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image7": {
      "main": [
        [
          {
            "node": "Edit Image6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript6": {
      "main": [
        [
          {
            "node": "Code in JavaScript7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image9": {
      "main": [
        [
          {
            "node": "Edit Image8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File1": {
      "main": [
        [
          {
            "node": "Edit Image9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript7": {
      "main": [
        [
          {
            "node": "Convert Base64 To File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File2": {
      "main": [
        [
          {
            "node": "Edit Image10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image10": {
      "main": [
        [
          {
            "node": "Analyze image2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image2": {
      "main": [
        [
          {
            "node": "Code in JavaScript8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript8": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code in JavaScript10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image11": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript9": {
      "main": [
        [
          {
            "node": "Convert Base64 To File3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image12": {
      "main": [
        [
          {
            "node": "Edit Image11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File3": {
      "main": [
        [
          {
            "node": "Edit Image12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript10": {
      "main": [
        [
          {
            "node": "Code in JavaScript11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript11": {
      "main": [
        [
          {
            "node": "Convert Base64 To File4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image13": {
      "main": [
        [
          {
            "node": "Analyze image3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File4": {
      "main": [
        [
          {
            "node": "Edit Image13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image3": {
      "main": [
        [
          {
            "node": "Code in JavaScript12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image14": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript13": {
      "main": [
        [
          {
            "node": "Convert Base64 To File5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image15": {
      "main": [
        [
          {
            "node": "Edit Image14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File5": {
      "main": [
        [
          {
            "node": "Edit Image15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript12": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image4": {
      "main": [
        [
          {
            "node": "Code in JavaScript14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Input ImageURL1": {
      "main": [
        [
          {
            "node": "Make URL Array1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make URL Array1": {
      "main": [
        [
          {
            "node": "Loop Over URLs1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over URLs1": {
      "main": [
        [
          {
            "node": "Make Base64 Array1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ImageURL To File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ImageURL To File1": {
      "main": [
        [
          {
            "node": "File To Base",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File To Base": {
      "main": [
        [
          {
            "node": "Loop Over URLs1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make Base64 Array1": {
      "main": [
        [
          {
            "node": "Attach Base",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Attach Base": {
      "main": [
        [
          {
            "node": "Convert Base64 To File6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File6": {
      "main": [
        [
          {
            "node": "Resize Image1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resize Image1": {
      "main": [
        [
          {
            "node": "Analyze image4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript14": {
      "main": [
        [
          {
            "node": "Code in JavaScript16",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image16": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript15": {
      "main": [
        [
          {
            "node": "Convert Base64 To File7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript16": {
      "main": [
        [
          {
            "node": "Code in JavaScript17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image17": {
      "main": [
        [
          {
            "node": "Edit Image16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File7": {
      "main": [
        [
          {
            "node": "Edit Image17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript17": {
      "main": [
        [
          {
            "node": "Convert Base64 To File8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image18": {
      "main": [
        [
          {
            "node": "Analyze image5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File8": {
      "main": [
        [
          {
            "node": "Edit Image18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image5": {
      "main": [
        [
          {
            "node": "Code in JavaScript18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript18": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code in JavaScript20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items6": {
      "main": [
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image19": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript19": {
      "main": [
        [
          {
            "node": "Convert Base64 To File9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image20": {
      "main": [
        [
          {
            "node": "Edit Image19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File9": {
      "main": [
        [
          {
            "node": "Edit Image20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript20": {
      "main": [
        [
          {
            "node": "Code in JavaScript21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript21": {
      "main": [
        [
          {
            "node": "Convert Base64 To File10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image21": {
      "main": [
        [
          {
            "node": "Analyze image6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File10": {
      "main": [
        [
          {
            "node": "Edit Image21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image6": {
      "main": [
        [
          {
            "node": "Code in JavaScript22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript22": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items7": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image22": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript23": {
      "main": [
        [
          {
            "node": "Convert Base64 To File11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image23": {
      "main": [
        [
          {
            "node": "Edit Image22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File11": {
      "main": [
        [
          {
            "node": "Edit Image23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Input ImageURL2": {
      "main": [
        [
          {
            "node": "Make URL Array2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make URL Array2": {
      "main": [
        [
          {
            "node": "Loop Over URLs2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over URLs2": {
      "main": [
        [
          {
            "node": "Make Base64 Array2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ImageURL To File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ImageURL To File2": {
      "main": [
        [
          {
            "node": "File To Base1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File To Base1": {
      "main": [
        [
          {
            "node": "Loop Over URLs2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make Base64 Array2": {
      "main": [
        [
          {
            "node": "Attach Base1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Attach Base1": {
      "main": [
        [
          {
            "node": "Code in JavaScript25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items8": {
      "main": [
        [
          {
            "node": "Edit Fields8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image24": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript24": {
      "main": [
        [
          {
            "node": "Convert Base64 To File13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image25": {
      "main": [
        [
          {
            "node": "Edit Image24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File13": {
      "main": [
        [
          {
            "node": "Edit Image25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript25": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Editor5": {
      "main": [
        [
          {
            "node": "MainImage Convert_14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_10": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MainImage Convert_14": {
      "main": [
        [
          {
            "node": "MainImage Convert_10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request7": {
      "main": [
        [
          {
            "node": "Convert to File9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet2": {
      "main": [
        [
          {
            "node": "Code in JavaScript26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript26": {
      "main": [
        [
          {
            "node": "HTTP Request7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet3": {
      "main": [
        [
          {
            "node": "Code in JavaScript27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript27": {
      "main": [
        [
          {
            "node": "Code in JavaScript28",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Input ImageURL3": {
      "main": [
        [
          {
            "node": "Make URL Array3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make URL Array3": {
      "main": [
        [
          {
            "node": "Loop Over URLs3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over URLs3": {
      "main": [
        [
          {
            "node": "Make Base64 Array3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ImageURL To File3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ImageURL To File3": {
      "main": [
        [
          {
            "node": "File To Base65",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File To Base65": {
      "main": [
        [
          {
            "node": "Loop Over URLs3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Make Base64 Array3": {
      "main": [
        [
          {
            "node": "Attach Base65",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Attach Base65": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File12": {
      "main": [
        [
          {
            "node": "Edit Image1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript28": {
      "main": [
        [
          {
            "node": "Convert Base64 To File12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze an image": {
      "main": [
        [
          {
            "node": "Code in JavaScript29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript30": {
      "main": [
        [
          {
            "node": "Convert Base64 To File14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File14": {
      "main": [
        [
          {
            "node": "Resize Image2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript29": {
      "main": [
        [
          {
            "node": "Code in JavaScript30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resize Image2": {
      "main": [
        [
          {
            "node": "Edit Image26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Image1": {
      "main": [
        [
          {
            "node": "Analyze image7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image7": {
      "main": [
        [
          {
            "node": "Code in JavaScript31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript31": {
      "main": [
        [
          {
            "node": "Code in JavaScript32",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Base64 To File15": {
      "main": [
        [
          {
            "node": "Resize Image3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript32": {
      "main": [
        [
          {
            "node": "Convert Base64 To File15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resize Image3": {
      "main": [
        [
          {
            "node": "Edit Image27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "Input ImageURL2": [
      {
        "json": {
          "ImageURL_1": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_1_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQ7nEGi0eYYg9gcG4bxFZP8mkh4nI3YDIbloshR6%252BM8yauaIIzCS%252BXb3ZIO0ZWaxSUorikoBgZEX2in4NAr5bEiuIvpqEUvP0SYIUNqc%252BTQl6u2Vohu7BTIC79aqOdzOWWo6m2zQomL3jg%252Fj7Ywkx%252F9Ri4q6GDCrQOGg%252BdBwTWOMgPbzEVU5TjhftnVVuDCXKPPFzRUuXTk1VFdV32sqYnKRSc5lKLetcRxbZhYIebfL5oKk56e1OT1Eg7uMH8rPH6Y5Ot%252BNraPvoWXvCb1RBYKvzOrduB3G%252Fo7tqTTaDhhoO2gwtGJ9dFuB%252BHljMbMYcxoTqhx0%252FMzLv9iEdUrpmjw%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_2": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3Dl8b99U19GJK0itQczA6WUU%252F1tiWQC5I2B8JqND812yblc2%252BSaj9pJHCPHY2g4BCbeapBu%252BaZ4bBnoW9JPFlTSFYcw%252FZAJb3RhovKvgMSxMjQrhhCTc0USrf1k6IIRoNRXt7gpeIjxGVZZKlgAJ6YFI7vzTWhhrL2oh1BsJk1H7NTr%252BSMDPyHhvwRpLGL%252FCDZiMz9%252BIyYBU0kqiu7SKeWtd7YTRhfJhOSrtL0JoajQvJVV9146pMEg3R0reY6vishcmMCPK1LGASFDbCNECkaf2qy9F2%252FjyR2O6dsLVUuytydHg3QYKzpQe1MceUwuGRQm1Z%252F14cKAbJ0GwL01cFY0w%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_3": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DeRybcTzm36NUPXbUHonVGTB%252BUxH%252BUyXasxRSXGYROjoyAWFW2NT4kDLHxVqVaI96kz1zvRd%252F79wkjpHLetB2Kj6m%252B4hMEFZjb9Lbvlla9utNRRbwQzlTtL7Q9FTZkUc1beO%252B080jr8mQ4K%252BcjUtIkBhWRINf14DkrWVur7mMeNz6PfzIhLxymiGC9Md4FsqI0DzouflNdkSpoFo09YJoYitLurpGSnmDtnh0RpTWKWX2Op3VHc5zx%252FAyTwOJo3z4xyCTm4hQ3AXtU7Pu8EaHMsdbSrQJNPh1j%252Fk4x5omVsKl6%252BfVcQ9sXGMQ8wA0j1waCuIPCK0VFHawweeBmx5LcQ%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_4": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DLLvkZTLNYpr0T0xk6QGAbcFwmpcYEDN6XDv60pTYCf5aDlDhxhTPlSAu5QVI4iSLcXZvAixk%252FbdYNTBjBdPsAShjyoby3Khh22LwWE2%252BFgoYXCJK8nFC2hATgOlsjckH5q0cwCxrQiac%252F6fJ1quWz91a1OT%252B1X0uw3CYDHY5e7ROYHCpmlnVCIn%252F4Nq32gzFybbDh9mdWAzaN2a45S%252B7Y%252FjufLIhIkAoxnZKJwpwLrpwg4UJXa0ITwdKaa1UomlHBj8vR95osdb2qahM48vSope3fuBvnd3VrE2kBmKQFQ7gPsfjQNCObRulsE2j8xxc%252BnDpS9tcX0QtnhEexv5mqA%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_5": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQZPlf7pD3fT4GKmpWEGI%252FNCIighC20lE6ecTZpESh9SSwt%252Bx7m2Ef0%252FAPq36970IIWNcpxI2BP3atNvAongWqurc%252B1mNzlcefdhWi2qT7sq8hcORtAdY1JFo7oG3L43tOyhqXHYWjMcpyhIJnPbq7C59Dy0GdI%252F4VeYBtY2%252F9Ms8l4PrTCPO7eeZAI1HMfYB4bjUGCogcLYBvL5Asrcr5eVoMKEoN1hANnELxKdeQQLtaKvs4OrGmEOiCGR5FvU6CNR7SP32%252B4fNJpzbg08MtcQTaL0Kb0eLNCdlWILhcJXLnu0%252B4rsPagNWHd%252BUd7jX2e2R6mdemCjZ0u53kme4rQ%253D%253D&width=800&format=webp&quality=100",
          "Json Code": ".",
          "submittedAt": "2025-11-30T22:05:51.694-05:00",
          "formMode": "test"
        }
      }
    ],
    "Make URL Array2": [
      {
        "json": {
          "index": 1,
          "key": "ImageURL_1",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_1_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQ7nEGi0eYYg9gcG4bxFZP8mkh4nI3YDIbloshR6%252BM8yauaIIzCS%252BXb3ZIO0ZWaxSUorikoBgZEX2in4NAr5bEiuIvpqEUvP0SYIUNqc%252BTQl6u2Vohu7BTIC79aqOdzOWWo6m2zQomL3jg%252Fj7Ywkx%252F9Ri4q6GDCrQOGg%252BdBwTWOMgPbzEVU5TjhftnVVuDCXKPPFzRUuXTk1VFdV32sqYnKRSc5lKLetcRxbZhYIebfL5oKk56e1OT1Eg7uMH8rPH6Y5Ot%252BNraPvoWXvCb1RBYKvzOrduB3G%252Fo7tqTTaDhhoO2gwtGJ9dFuB%252BHljMbMYcxoTqhx0%252FMzLv9iEdUrpmjw%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 2,
          "key": "ImageURL_2",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3Dl8b99U19GJK0itQczA6WUU%252F1tiWQC5I2B8JqND812yblc2%252BSaj9pJHCPHY2g4BCbeapBu%252BaZ4bBnoW9JPFlTSFYcw%252FZAJb3RhovKvgMSxMjQrhhCTc0USrf1k6IIRoNRXt7gpeIjxGVZZKlgAJ6YFI7vzTWhhrL2oh1BsJk1H7NTr%252BSMDPyHhvwRpLGL%252FCDZiMz9%252BIyYBU0kqiu7SKeWtd7YTRhfJhOSrtL0JoajQvJVV9146pMEg3R0reY6vishcmMCPK1LGASFDbCNECkaf2qy9F2%252FjyR2O6dsLVUuytydHg3QYKzpQe1MceUwuGRQm1Z%252F14cKAbJ0GwL01cFY0w%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 3,
          "key": "ImageURL_3",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DeRybcTzm36NUPXbUHonVGTB%252BUxH%252BUyXasxRSXGYROjoyAWFW2NT4kDLHxVqVaI96kz1zvRd%252F79wkjpHLetB2Kj6m%252B4hMEFZjb9Lbvlla9utNRRbwQzlTtL7Q9FTZkUc1beO%252B080jr8mQ4K%252BcjUtIkBhWRINf14DkrWVur7mMeNz6PfzIhLxymiGC9Md4FsqI0DzouflNdkSpoFo09YJoYitLurpGSnmDtnh0RpTWKWX2Op3VHc5zx%252FAyTwOJo3z4xyCTm4hQ3AXtU7Pu8EaHMsdbSrQJNPh1j%252Fk4x5omVsKl6%252BfVcQ9sXGMQ8wA0j1waCuIPCK0VFHawweeBmx5LcQ%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 4,
          "key": "ImageURL_4",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DLLvkZTLNYpr0T0xk6QGAbcFwmpcYEDN6XDv60pTYCf5aDlDhxhTPlSAu5QVI4iSLcXZvAixk%252FbdYNTBjBdPsAShjyoby3Khh22LwWE2%252BFgoYXCJK8nFC2hATgOlsjckH5q0cwCxrQiac%252F6fJ1quWz91a1OT%252B1X0uw3CYDHY5e7ROYHCpmlnVCIn%252F4Nq32gzFybbDh9mdWAzaN2a45S%252B7Y%252FjufLIhIkAoxnZKJwpwLrpwg4UJXa0ITwdKaa1UomlHBj8vR95osdb2qahM48vSope3fuBvnd3VrE2kBmKQFQ7gPsfjQNCObRulsE2j8xxc%252BnDpS9tcX0QtnhEexv5mqA%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 5,
          "key": "ImageURL_5",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FcefNrJ6ha7227ka_z3_tr%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DQZPlf7pD3fT4GKmpWEGI%252FNCIighC20lE6ecTZpESh9SSwt%252Bx7m2Ef0%252FAPq36970IIWNcpxI2BP3atNvAongWqurc%252B1mNzlcefdhWi2qT7sq8hcORtAdY1JFo7oG3L43tOyhqXHYWjMcpyhIJnPbq7C59Dy0GdI%252F4VeYBtY2%252F9Ms8l4PrTCPO7eeZAI1HMfYB4bjUGCogcLYBvL5Asrcr5eVoMKEoN1hANnELxKdeQQLtaKvs4OrGmEOiCGR5FvU6CNR7SP32%252B4fNJpzbg08MtcQTaL0Kb0eLNCdlWILhcJXLnu0%252B4rsPagNWHd%252BUd7jX2e2R6mdemCjZ0u53kme4rQ%253D%253D&width=800&format=webp&quality=100"
        }
      }
    ],
    "Input ImageURL3": [
      {
        "json": {
          "ImageURL_1": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DmLuCCEJ77UkK4z3euJ4YRsSPTZWeOn4PgacQrkxYSOxt6MypID7LJB9NHH4JqWCYDpoBY%252FC3x0SQnShngKnuofYD3ybBgZIxmDi1eyuMmJHIH1tCw4PwINVPKCnupJ41aUj4VC0PcJRYzxl3dxj9tFDt5br1AnFgM9yj8WARbD5d8Ai0rEev%252FH5Z1%252BJkQEOXdo2swQh9f7vUWc337uWrNHIXRJXeMGakZdl%252BZo8mB7TVk2TmvnjsZ9n0RoZNe9wfk6n0OKX1PHMLDiqj3SnYMuX9xhqj8x0JS%252Bdbnih0iiYODkl86F5Nou4kglq6a%252BAcNzt4vYqExB1V%252BFAf8qwvpw%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_2": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DgPjnoxV%252BPPKSCGGdG2omUnVK0dzA3omugbZlfM1FwcO0blJJT3ccOhgJGKalGwde9LrgZ3s8sIjHD0rnbJ%252BCWGI6YKvdmInJSijQu2FvVda4Xo%252FAJS1ras2%252BFD0pI%252BNMMI0SLhN7CKTCl4JrLSs%252FtmhoMnnpSbtGuDNzLXMusEBxPpNJ1FO49uC9lRrYntT%252FahyjWBq2yRc%252FWGDVZuvmWjX2LvvpSDM%252FDBfcCvnO8WoIH7IC8cPqXDKr32lDDWerFaEAEdu%252BU6dIMI9x5BFCO21enKTylF7eUpIGzD1kVxa5735P%252B%252FRmhWHa99jrBaQHxcb7IaybCSQc%252Fm2zP0%252B%252BuQ%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_3": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DXyIAceXikwYinjCIGCgBevN7UL5Xw4I9nc0XjK0n3srJQAfA%252BeKAvLaf5hfeVW7%252Fst93wOO8o%252B%252FWkVK0xLeWje4F6ORGIZ8AUpRkBoiA8qQMMMPv5MfAIpZ%252FJ4VVnWv7cFdWIJkYC4uIFeUyr0lrS43XXlaGSP%252BAZziu1W8jxVFeS1XyJUqOdn4uihoQMSiVBseGbWRaCeBuMloy%252F%252Bzrk82VwhYMM2LCzXlwZh21k%252Bq%252FHLPo5fuV6nCk0P1Rp%252BDG%252BTCQ%252BFbOfoD7geQhbXglYlg63dkvFfTs6mUCL54cIEqG09Us3UWpx9Teo4%252B0x4VeEVVBHhHRasX%252B%252BLifP9Fs%252Bg%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_4": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DFctJOATLvnzuc%252FLzdyA1FqRlcoLeTudvwMBRlJd3ij%252BWqxuUB%252B2P9MnrgMk1Su5SYsRXp8Q%252B%252BTQXCkBEgkl2UMKmO1Nh%252FM8jepDrF8MwAjGdN8ihRmodinvlZb5qlia%252B9SbBbMxRgMNMY750CWjMO11nZUCKMcIEEkZemFA0%252BeCCuXN5fAGNcL2hsKO5Cx3JSgT%252FlpgyzfMTZgyD8KIn%252BL7cn1%252B41qWubvL6TE1sJjD4HYDoPzSJ84Y%252BjOyt%252B6gGgKoanM8hFr0bmS0T04akRryIcVLVimQupJ4WAMpBDOY4n1E%252BRDSRK0FaI6dAfIWkOGs6K%252Ft9PYMNaw8mplLoTg%253D%253D&width=800&format=webp&quality=100",
          "ImageURL_5": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DB3yEO6kn43rLE5MloUiSoKKN%252BBlMuF7lRKx2qOr336P2eqncgVPjU7lfCaoENBMsYtOJHoQpbP3vNBUwa6zOcsMJlSl9Y1jffSvEY4d2H5cl19Stit%252Fvh3EtUWIDfMTsWWtEy9lRLfOSvOotv6Pwrx%252Boyh4CGKaeTMs2I9M4Z7nbkgGvGIw5svGwVCm8HaiRHYlDoVmh4iMTlzI9ivfYF%252BesH%252BbmPuAN89JAEartx3nL1Q1I8xGXc9BdZ7ANcbL%252Fs5bBeTlFCvw1VFRsZHnqBrVyTMSJkhokDGwxEjfowJDHoy7kdb4A830FBJMpL%252Bjwuhu3nUSPEvEWK1CNRlfDEA%253D%253D&width=800&format=webp&quality=100",
          "submittedAt": "2025-11-30T23:23:55.363-05:00",
          "formMode": "test"
        }
      }
    ],
    "Make URL Array3": [
      {
        "json": {
          "index": 1,
          "key": "ImageURL_1",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DmLuCCEJ77UkK4z3euJ4YRsSPTZWeOn4PgacQrkxYSOxt6MypID7LJB9NHH4JqWCYDpoBY%252FC3x0SQnShngKnuofYD3ybBgZIxmDi1eyuMmJHIH1tCw4PwINVPKCnupJ41aUj4VC0PcJRYzxl3dxj9tFDt5br1AnFgM9yj8WARbD5d8Ai0rEev%252FH5Z1%252BJkQEOXdo2swQh9f7vUWc337uWrNHIXRJXeMGakZdl%252BZo8mB7TVk2TmvnjsZ9n0RoZNe9wfk6n0OKX1PHMLDiqj3SnYMuX9xhqj8x0JS%252Bdbnih0iiYODkl86F5Nou4kglq6a%252BAcNzt4vYqExB1V%252BFAf8qwvpw%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 2,
          "key": "ImageURL_2",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_1.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DgPjnoxV%252BPPKSCGGdG2omUnVK0dzA3omugbZlfM1FwcO0blJJT3ccOhgJGKalGwde9LrgZ3s8sIjHD0rnbJ%252BCWGI6YKvdmInJSijQu2FvVda4Xo%252FAJS1ras2%252BFD0pI%252BNMMI0SLhN7CKTCl4JrLSs%252FtmhoMnnpSbtGuDNzLXMusEBxPpNJ1FO49uC9lRrYntT%252FahyjWBq2yRc%252FWGDVZuvmWjX2LvvpSDM%252FDBfcCvnO8WoIH7IC8cPqXDKr32lDDWerFaEAEdu%252BU6dIMI9x5BFCO21enKTylF7eUpIGzD1kVxa5735P%252B%252FRmhWHa99jrBaQHxcb7IaybCSQc%252Fm2zP0%252B%252BuQ%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 3,
          "key": "ImageURL_3",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_2.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DXyIAceXikwYinjCIGCgBevN7UL5Xw4I9nc0XjK0n3srJQAfA%252BeKAvLaf5hfeVW7%252Fst93wOO8o%252B%252FWkVK0xLeWje4F6ORGIZ8AUpRkBoiA8qQMMMPv5MfAIpZ%252FJ4VVnWv7cFdWIJkYC4uIFeUyr0lrS43XXlaGSP%252BAZziu1W8jxVFeS1XyJUqOdn4uihoQMSiVBseGbWRaCeBuMloy%252F%252Bzrk82VwhYMM2LCzXlwZh21k%252Bq%252FHLPo5fuV6nCk0P1Rp%252BDG%252BTCQ%252BFbOfoD7geQhbXglYlg63dkvFfTs6mUCL54cIEqG09Us3UWpx9Teo4%252B0x4VeEVVBHhHRasX%252B%252BLifP9Fs%252Bg%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 4,
          "key": "ImageURL_4",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_3_3.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DFctJOATLvnzuc%252FLzdyA1FqRlcoLeTudvwMBRlJd3ij%252BWqxuUB%252B2P9MnrgMk1Su5SYsRXp8Q%252B%252BTQXCkBEgkl2UMKmO1Nh%252FM8jepDrF8MwAjGdN8ihRmodinvlZb5qlia%252B9SbBbMxRgMNMY750CWjMO11nZUCKMcIEEkZemFA0%252BeCCuXN5fAGNcL2hsKO5Cx3JSgT%252FlpgyzfMTZgyD8KIn%252BL7cn1%252B41qWubvL6TE1sJjD4HYDoPzSJ84Y%252BjOyt%252B6gGgKoanM8hFr0bmS0T04akRryIcVLVimQupJ4WAMpBDOY4n1E%252BRDSRK0FaI6dAfIWkOGs6K%252Ft9PYMNaw8mplLoTg%253D%253D&width=800&format=webp&quality=100"
        }
      },
      {
        "json": {
          "index": 5,
          "key": "ImageURL_5",
          "url": "https://img.rewake.co.kr/resize?url=https%3A%2F%2Fstorage.googleapis.com%2Fwake-app-soonicorn.appspot.com%2Fadmin%2Fklache%2FLheRwc5wG0pNiIOW07ihq%2Fsub%2Fimage_5_0.webp%3FGoogleAccessId%3Dfirebase-adminsdk-gcx27%2540wake-app-soonicorn.iam.gserviceaccount.com%26Expires%3D16730290800%26Signature%3DB3yEO6kn43rLE5MloUiSoKKN%252BBlMuF7lRKx2qOr336P2eqncgVPjU7lfCaoENBMsYtOJHoQpbP3vNBUwa6zOcsMJlSl9Y1jffSvEY4d2H5cl19Stit%252Fvh3EtUWIDfMTsWWtEy9lRLfOSvOotv6Pwrx%252Boyh4CGKaeTMs2I9M4Z7nbkgGvGIw5svGwVCm8HaiRHYlDoVmh4iMTlzI9ivfYF%252BesH%252BbmPuAN89JAEartx3nL1Q1I8xGXc9BdZ7ANcbL%252Fs5bBeTlFCvw1VFRsZHnqBrVyTMSJkhokDGwxEjfowJDHoy7kdb4A830FBJMpL%252Bjwuhu3nUSPEvEWK1CNRlfDEA%253D%253D&width=800&format=webp&quality=100"
        }
      }
    ]
  },
  "tags": [],
  "versionId": "78bd70ec-676f-4927-9f08-d5f133201acb"
}